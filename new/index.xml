<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>News on 小类随手记</title><link>https://dev.leiyanhui.com/new/</link><description>Recent content in News on 小类随手记</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Thu, 30 Mar 2023 08:14:20 +0800</lastBuildDate><atom:link href="https://dev.leiyanhui.com/new/index.xml" rel="self" type="application/rss+xml"/><item><title>自己搭建云手机，投屏，消息通知给iPhone 等</title><link>https://dev.leiyanhui.com/new/scrcpy-ios/</link><pubDate>Thu, 30 Mar 2023 08:14:20 +0800</pubDate><guid>https://dev.leiyanhui.com/new/scrcpy-ios/</guid><description>&lt;h3 id="场景">场景
&lt;/h3>&lt;p>主力手机 iPhone，安卓手机不随身带。 手机号码多个，微信多个。&lt;/p>
&lt;h3 id="痛点">痛点
&lt;/h3>&lt;p>因为ios上微信多开比较麻烦，虽然有ios开发者账号，但是更新和封号 都麻烦很多。&lt;/p>
&lt;h3 id="需要解决">需要解决
&lt;/h3>&lt;ul>
&lt;li>多手机号码 一个iPhone一个手机接听&lt;/li>
&lt;li>一个手机可以接收其他手机的微信消息&lt;/li>
&lt;li>部分只有app的软件 电脑上使用&lt;/li>
&lt;li>安卓app开发调试&lt;/li>
&lt;/ul>
&lt;h3 id="硬件方案">硬件方案
&lt;/h3>&lt;p>安卓备用机一台（红米4x）放家里，pve下 usb直通 或者wifi连接到 开发机。&lt;/p>
&lt;h3 id="软件解决方案">软件解决方案
&lt;/h3>&lt;ul>
&lt;li>远程控制手机：自建rustdesk中转，解决外出远程控制安卓手机的问题。（也可以用scrcpy-ios 过于麻烦）&lt;/li>
&lt;li>pc机上直接使用手机：scrcpy&lt;/li>
&lt;li>消息转发，安卓手机消息，转发给主力手机&lt;/li>
&lt;/ul>
&lt;h3 id="相关代码和工具">相关代码和工具
&lt;/h3>&lt;h4 id="adb-wifi-连接">adb wifi 连接
&lt;/h4>&lt;p>先usb连接到pc，打开手机的usb调试等，pc安装scrcpy，可以正常使用usb投屏的情况下。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">D:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cd D:\soft\scrcpy-win64-v2.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">adb tcpip 5555
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>然后断开usb，路由器里面配置dhcp静态ip给安卓手机 例如 10.1.1.14&lt;br>
创建 _startWifi.bat&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">D:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cd D:\soft\scrcpy-win64-v2.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">adb connect 10.1.1.14:5555
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">scrcpy.exe
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;blockquote>
&lt;p>wifi连接 略微卡顿，看视频会更差一些。可惜我手上的安卓数据线 只有一条，还要做别的用。暂时凑合一下。&lt;/p>&lt;/blockquote>
&lt;h4 id="隐藏cmdvbs">隐藏cmd.vbs
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">CreateObject(&amp;#34;WScript.Shell&amp;#34;).Run &amp;#34;cmd /c D:\soft\scrcpy-win64-v2.0\_startWifi.bat&amp;#34;,0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="安卓消息转发">安卓消息转发
&lt;/h3>&lt;p>用 通知滤盒 这个app，规则里面 规则 增强，webhook 输入 企业微信/钉钉机器人的webhook 或 Bark(ios) 或 各种微信公众号消息通知的webhook 例： wxpusher pushplus Server酱 coolpush 等
通知滤盒 正版不贵，破解版 网上也有。&lt;/p>
&lt;h4 id="通知滤盒---bark-默认通知地址">通知滤盒 -&amp;gt; Bark 默认通知地址
&lt;/h4>&lt;p>感谢Bark 作者&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://api.day.app/XXXXXXXXXXXXXXXXXXXX/{android.title}/{filterbox.field.APP_NAME}-{android.text}?sound=birdsong&amp;amp;isArchive=1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="其他">其他
&lt;/h3>&lt;h4 id="单iphone手机多号码方案">单iPhone手机多号码方案
&lt;/h4>&lt;p>1阿里小号 2移动 无忧行 3 其他：安卓手机短信转发 手机互转等&lt;/p>
&lt;h4 id="scrcpy自动黑屏">scrcpy自动黑屏
&lt;/h4>&lt;p>安卓手机设置 usb调试选项里面 设置充电时候不熄屏幕，然后拆掉屏幕。拆掉屏幕不方便，不然还是忍一下吧。。&lt;br>
或者屏幕亮度调到最低 也行&lt;/p>
&lt;h4 id="电池问题">电池问题
&lt;/h4>&lt;p>从保护板后面剪掉电池，接4.2v dc电源 + 一个电解电容+限流电阻。或者 干脆一个大一点的电解电容+一个限流电阻 完事。&lt;/p>
&lt;h4 id="scrcpy-常用快捷键">scrcpy 常用快捷键
&lt;/h4>&lt;p>我这里mod键 是 alt&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">MOD + f 切换到全屏 / 取消全屏
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MOD + 左 往左旋转屏幕
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MOD + 右 往右旋转屏幕
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MOD + g 重置屏幕尺寸到 像素比1:1（一般都是变得硕大）
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MOD + w 重置屏幕尺寸消除黑色边框
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MOD + h 等同于 home 键
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MOD + b 等同于 返回 键
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MOD + s 等同于切换app操作
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MOD + m 对应解锁屏的按键，如果是锁屏的话，仅点亮屏幕
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MOD + 下 减少音量
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MOD + 上 增加音量
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MOD + p 等同于按电源键
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">右键点击 等同于点亮屏幕
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MOD + o 把设备屏幕关闭但保持镜像同步
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MOD + Shift + o 点亮设备屏幕
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MOD + r 旋转屏幕（测试好像不好用，不知道是不是快捷键冲突）
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MOD + n 打开消息面板
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MOD + n + n 双击n，打开顶部设置栏
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MOD + shift + n 收起面板
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MOD + c 同步复制到电脑剪贴板
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MOD + x 同步剪贴到电脑剪贴板
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MOD + v 同步粘贴电脑剪贴板的内容（pc-&amp;gt;手机或手机-&amp;gt;pc均可）
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MOD + i 启用或禁用FPS计数
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Ctrl + 点击和移动 相当于多指捏合动作
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">安装APK 拖拽APK文件到窗口
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">推送文件到手机 拖拽非APK文件到窗口
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="升级方案">升级方案
&lt;/h3>&lt;p>骁龙835 150-350元左右 300一下的基本不能插卡&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">MOTOz2f
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lgv30
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">夏普r（shv39）
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">小白推荐：米6 mix2 三星s8 努比亚z17 索尼xz1/xzp[doge]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">坚果Pro2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">夏普rc（701sh）
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">中兴blade a7
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">诺基亚x5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">三星s6/s6edge/edge+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">魅族Pro5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">红米note3（这玩意一定要买全网通晓龙650的，楼主之前收了部双网，直接卡死[辣眼睛]）
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">乐视2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">小米Max
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">红米note4x
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">360n4s晓龙版（楼主收过，刷个MIUI很香哒[嗑瓜子]）
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">中国移动n2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;a class="link" href="https://www.bilibili.com/video/BV11L411n7zi/" target="_blank" rel="noopener"
>https://www.bilibili.com/video/BV11L411n7zi/&lt;/a> 参考&lt;/p></description></item><item><title>良友电台app</title><link>https://dev.leiyanhui.com/new/radio-ly/</link><pubDate>Wed, 11 Jan 2023 17:14:20 +0800</pubDate><guid>https://dev.leiyanhui.com/new/radio-ly/</guid><description>&lt;h2 id="前">前
&lt;/h2>&lt;p>家人要听良友电台，之前都是使用web方式 给她在手机桌面创建webapp到 &lt;code>https://ly729.airtime.pro/embed/player?stream=s1&amp;amp;skin=2&lt;/code>&lt;/p>
&lt;p>而后发现诸多不便&lt;/p>
&lt;p>于是还是简单弄一个app&lt;/p>
&lt;h2 id="源地址">源地址
&lt;/h2>&lt;p>从 &lt;a class="link" href="https://tx.729ly.net/zh-sc/" target="_blank" rel="noopener"
>https://tx.729ly.net/zh-sc/&lt;/a> 获取到三个地址&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-dart" data-lang="dart">&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="n">source1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;https://ly729.out.airtime.pro/ly729_a&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="n">source2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;https://c20.radioboss.fm/stream/572&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="n">source3&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;https://listen.729ly.net:8001/ly729_a&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="仓库地址">仓库地址
&lt;/h2>&lt;p>&lt;a class="link" href="https://github.com/joyanhui/radio_ly" target="_blank" rel="noopener"
>https://github.com/joyanhui/radio_ly&lt;/a>&lt;/p>
&lt;h2 id="使用库">使用库
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">cupertino_icons&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">^1.0.2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">audioplayers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">^5.2.1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">flutter_launcher_icons&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;^0.13.1&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">url_launcher&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">^6.2.2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="自己编译">自己编译
&lt;/h2>&lt;p>linux下需要&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">sudo apt-get install clang cmake ninja-build pkg-config libgtk-3-dev liblzma-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo apt-get install libgstreamer1.0-dev libgstreamer-plugins-base1.0-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo apt-get install gstreamer1.0-plugins-good gstreamer1.0-plugins-bad
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>windows下&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">https://github.com/bluefireteam/audioplayers/blob/main/packages/audioplayers_windows/README.md#setup-for-windows
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="自定义源测试地址">自定义源测试地址
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">http://satellitepull.cnr.cn/live/wxnxxwgb/playlist.m3u8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">http://sk.cri.cn/887.m3u8
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>all in one 可以满足多数人的方案和选择 个人看法</title><link>https://dev.leiyanhui.com/new/all-in-one-select/</link><pubDate>Fri, 28 Oct 2022 17:14:20 +0800</pubDate><guid>https://dev.leiyanhui.com/new/all-in-one-select/</guid><description>&lt;h2 id="先说适合我自己的all-in-one方案">先说适合我自己的all in one方案
&lt;/h2>&lt;p>首先，不建议主路由 挂这里。主路由还是独立出来，不然动则全家 全公司不能上网，被喷死&lt;/p>
&lt;p>所以 我路由器 还是独立的， 刷的 openwrt，但是因为flash容量的原因，无法在 路由上直接挂代理。 代理还是放到了all in one 主机的docker里面高&lt;/p>
&lt;p>功能的需求上&lt;/p>
&lt;p>需要 nas，做监控的储存，smb协议&lt;/p>
&lt;p>外网和局域网的文件共享，我才用webdav。我自己有用golang写了一个简单的跨平台的webdavgo &lt;a class="link" href="https://github.com/joyanhui/webdavgo" target="_blank" rel="noopener"
>在这里&lt;/a>&lt;/p>
&lt;p>外网访问的问题，因为我有公网ip所以，，这个不是问题。。。你如果没有 随便找一个穿透方案就好了。&lt;/p>
&lt;h2 id="几种主流的系统对比">几种主流的系统对比
&lt;/h2>&lt;ul>
&lt;li>黑群晖
&lt;ul>
&lt;li>优点：简单易用&lt;/li>
&lt;li>缺点：
&lt;ul>
&lt;li>毕竟是破解。。。不推荐&lt;/li>
&lt;li>内核老&lt;/li>
&lt;li>深度定制的linux 不适合折腾&lt;/li>
&lt;li>挑网卡 不过可以打补丁&lt;/li>
&lt;li>特殊硬件直通 相对困难很多&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>esxi
&lt;ul>
&lt;li>优点：简单易用，据说多数&lt;/li>
&lt;li>缺点
&lt;ul>
&lt;li>并非linux
&lt;ul>
&lt;li>docker 只能虚拟机跑&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>挑网卡，挑硬件 很多个人电脑网卡无法用，额外添加驱动时间成本很高&lt;/li>
&lt;li>商业化软件，个人免费&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>unraid
&lt;ul>
&lt;li>优点：不占用硬盘，U盘使用，系统备份什么的都很方便&lt;/li>
&lt;li>缺点：
&lt;ul>
&lt;li>必须依赖梯子 改hosts方案不稳定&lt;/li>
&lt;li>收费，并不便宜 而且绑定U盘的 一年只可以换一次&lt;/li>
&lt;li>破解版 有后门可能，有一些有挖矿代码&lt;/li>
&lt;li>特殊情况的下在的直通 兼容性很差&lt;/li>
&lt;li>web界面有时候抽风 很卡 反应迟钝&lt;/li>
&lt;li>挑U盘，部分U盘没有唯一uuid的，没法用&lt;/li>
&lt;li>虽然不怎么影响U盘寿命，但是很多人还是坏过U盘&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>pve
&lt;ul>
&lt;li>优点&lt;/li>
&lt;li>基于debian11 可以玩性强，也可以 在debian上附加安装，并非深度定制的debian&lt;/li>
&lt;li>基本不挑硬件&lt;/li>
&lt;li>缺点&lt;/li>
&lt;li>比上述所有系统都要复杂一点，需要有一点linux基础才可以玩的开心&lt;/li>
&lt;li>docker 需要另外安装，或者lxc里面跑，也不算缺点 主要看你docker用多少&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>自己安装linux + kvm
&lt;ul>
&lt;li>优点
&lt;ul>
&lt;li>灵活可控&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>缺点
&lt;ul>
&lt;li>参考pve&lt;/li>
&lt;li>需要你linux技术和kvm了解程度高一些&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="我的选择">我的选择：
&lt;/h2>&lt;h3 id="目前">目前
&lt;/h3>&lt;p>ventoy 硬盘安装，pve 安装到vhd启动&lt;/p>
&lt;ul>
&lt;li>优点
&lt;ul>
&lt;li>可以和unraid一样方便备份&lt;/li>
&lt;li>灵活&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>缺点
&lt;ul>
&lt;li>除了pve本身的缺点没法别的&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="未来">未来
&lt;/h3>&lt;p>有时间 会单独弄一个 arch 或者 ubuntu 独立安装kvm&lt;/p></description></item><item><title>2022是否应该彻底抛弃gitee了</title><link>https://dev.leiyanhui.com/new/gitee-drop/</link><pubDate>Sat, 22 Oct 2022 00:00:00 +0000</pubDate><guid>https://dev.leiyanhui.com/new/gitee-drop/</guid><description>&lt;h1 id="2022是否应该彻底抛弃gitee了">2022是否应该彻底抛弃gitee了
&lt;/h1>&lt;h2 id="gitee-怎么这么恶心">gitee 怎么这么恶心
&lt;/h2>&lt;h3 id="屏蔽外链事件">屏蔽外链事件
&lt;/h3>&lt;p>之前gitee 突然无征兆屏蔽外链事件，可以理解为政策或者成本因素。可以理解。。。&lt;/p>
&lt;h3 id="还有2019年的dns事件">还有2019年的dns事件
&lt;/h3>&lt;p>虽然是阿里单方面屏蔽的，但是你和dns厂商就没有有效的沟通渠道吗&lt;/p>
&lt;h3 id="md文件链接强加前缀">md文件链接强加前缀
&lt;/h3>&lt;p>现在 md文件 在线预览 链接地址 强制加前缀也是服了&lt;/p>
&lt;p>&lt;code>https://gitee.com/link?target=XXXXXX&lt;/code>&lt;/p>
&lt;h3 id="gitee的网页速度也开始变慢">gitee的网页速度也开始变慢
&lt;/h3>&lt;p>不知为什么加载了那么一堆乱七八糟的东西，越来越卡&lt;/p>
&lt;h3 id="gitee-page-好像是玩具">gitee page 好像是玩具
&lt;/h3>&lt;p>其实没搞明白 他这个好像是需要手动刷新同步的。。。 和 github pages 压根两个概念&lt;/p>
&lt;p>并且也不不可以绑定独立域名，哪怕已经备案的&lt;/p>
&lt;h2 id="我的选择">我的选择
&lt;/h2>&lt;p>其实阿里codeup和腾讯的codeing 也不错&lt;/p>
&lt;p>我的选择，私有库 codeup，开源库github（gitee只做镜像）
私有库=&amp;gt; pages 阿里云oss
开源库=&amp;gt; pages github=&amp;gt;国内cdn（境外回源）&lt;/p>
&lt;h2 id="其他选择">其他选择
&lt;/h2>&lt;p>cdsn家的 &lt;a class="link" href="https://gitcode.net/" target="_blank" rel="noopener"
>https://gitcode.net/&lt;/a>&lt;/p></description></item><item><title>archlinux 安装宝塔记录</title><link>https://dev.leiyanhui.com/new/archlinux-install-bt/</link><pubDate>Sat, 22 Oct 2022 00:00:00 +0000</pubDate><guid>https://dev.leiyanhui.com/new/archlinux-install-bt/</guid><description>&lt;h1 id="archlinux-安装宝塔记录">archlinux 安装宝塔记录
&lt;/h1>&lt;h2 id="安装arch">安装arch
&lt;/h2>&lt;p>下载 archlinux-2022.10.01-x86_64.iso 挂到主机
启动后
archinstall 自动安装&lt;/p>
&lt;h2 id="arch安装一些基本包">arch安装一些基本包
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pacman -S openssh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl enable sshd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl start sshd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S wget unzip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S make
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S core/gcc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S cmake
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S pkg-config
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#php需要一些依赖
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S libsodium sqlite oniguruma libwebp libvpx openssl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -Syu gtk4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S autoconf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>可能需要 创建 /etc/bt.local&lt;/p></description></item><item><title>docker运行的clash自动更新订阅</title><link>https://dev.leiyanhui.com/new/docker-clash-autoupdate/</link><pubDate>Sat, 22 Oct 2022 00:00:00 +0000</pubDate><guid>https://dev.leiyanhui.com/new/docker-clash-autoupdate/</guid><description>&lt;h1 id="docker运行的clash自动更新订阅">docker运行的clash自动更新订阅
&lt;/h1>&lt;p>我们用两个容器 实现了 基于docker的可视化clash&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">docker run --restart=always -p 7880:80 -d --name clash-web haishanh/yacd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker run -d --name=clash -v &amp;#34;/www/wwwroot/clash.config.yaml:/root/.config/clash/config.yaml&amp;#34; -p &amp;#34;7890:7890&amp;#34; -p &amp;#34;7891:7891&amp;#34; -p &amp;#34;9090:9090&amp;#34; --restart=unless-stopped dreamacro/clash-premium
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>clash.config.yaml&lt;/code> 这个文件 是我们从 某些订阅平台拿到的。但是里面的一些配置项目 ，比如 没有打开 局域网访问，还有9090 端口 只允许本机链接等
就是下面两个&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">allow-lan: true
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">external-controller: &amp;#39;0.0.0.0:9090&amp;#39;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>先找一个在线订阅转化工具 百度搜有很多，比如 &lt;code>https://ppc.linshenkx.cn/&lt;/code> 也可以自己搭建
&lt;code>https://github.com/qier222/proxy-provider-converter&lt;/code>&lt;/p>
&lt;h2 id="自己搭建转化服务">自己搭建转化服务
&lt;/h2>&lt;p>我这里直接使用 tindy2013/subconverter 查看官网文档 &lt;code>https://github.com/tindy2013/subconverter/blob/master/README-cn.md&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">docker run -d --restart=always -p 25500:25500 tindy2013/subconverter:latest
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>http://你的ip:25500/sub?target=clash&amp;amp;url=订阅地址URLEncode&lt;/p>
&lt;p>可以直接拿到一个可用的修改好的.yaml&lt;/p>
&lt;p>剩下的就简单了&lt;/p>
&lt;p>在容器外部添加一个定时任务shell&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd /www/wwwroot/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -o new.clash.yaml &amp;#39;http://10.0.0.9:25500/sub?target=clash&amp;amp;url=https%3A%2F%2Fxn--xxxxx.com%2Fapi%2Fv1%2Fclient%2Fsubscribe%3Ftoken%xxx&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm -rf clash.config.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv new.clash.yaml clash.config.yaml
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>或许真的到了放弃centos7的时间了</title><link>https://dev.leiyanhui.com/new/centos7-is-die/</link><pubDate>Sat, 22 Oct 2022 00:00:00 +0000</pubDate><guid>https://dev.leiyanhui.com/new/centos7-is-die/</guid><description>&lt;h1 id="或许真的到了放弃centos7的时间了">或许真的到了放弃centos7的时间了。
&lt;/h1>&lt;p>今天折腾mdBook Rust，然后发现竟然不支持centos7 原因是GLIBC太老了
但是GLIBC 和系统核心相关，升级的话 还是非常麻烦&lt;/p>
&lt;p>只好尝试升级到Centos Stream 8&lt;/p>
&lt;p>其实很想用archlinux，但&lt;/p>
&lt;h2 id="安装epel-relaseyum-utils和rpmconf">安装epel-relase、yum-utils和rpmconf
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">yum install yum-utils epel-release -y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum install rpmconf -y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="安装前检查">安装前检查
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">rpmconf -a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">package-cleanup --leaves
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">package-cleanup --orphans
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="安装dnf-并执行更新">安装dnf 并执行更新
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">yum install dnf -y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dnf remove yum yum-metadata-parser -y &amp;amp;&amp;amp; rm -rf /etc/yum
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dnf upgrade -y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dnf upgrade https://mirrors.bfsu.edu.cn/centos-vault/8.0.1905/BaseOS/x86_64/os/Packages/centos-release-8.0-0.1905.0.9.el8.x86_64.rpm -y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dnf upgrade https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm -y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="删除无用文件centos-7的内核更换vault源和移除无法升级的包并安装centos-8的内核">删除无用文件、CentOS 7的内核、更换Vault源和移除无法升级的包并安装CentOS 8的内核
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">dnf&lt;/span> &lt;span class="n">clean&lt;/span> &lt;span class="n">all&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rpm&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">e&lt;/span> &lt;span class="err">`&lt;/span>&lt;span class="n">rpm&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">q&lt;/span> &lt;span class="n">kernel&lt;/span>&lt;span class="err">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rpm&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">e&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">nodeps&lt;/span> &lt;span class="n">sysvinit&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">tools&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">minorver&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mf">8.0&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1905&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sudo&lt;/span> &lt;span class="n">sed&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">e&lt;/span> &lt;span class="s2">&amp;#34;s|^mirrorlist=|#mirrorlist=|g&amp;#34;&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span>&lt;span class="n">e&lt;/span> &lt;span class="s2">&amp;#34;s|^#baseurl=http://mirror.centos.org/\$contentdir/\$releasever|baseurl=https://mirrors.tuna.tsinghua.edu.cn/centos-vault/$minorver|g&amp;#34;&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">bak&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">yum&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">repos&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">d&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">CentOS&lt;/span>&lt;span class="o">-*.&lt;/span>&lt;span class="n">repo&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">dnf&lt;/span> &lt;span class="n">remove&lt;/span> &lt;span class="n">python36&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rpmconf&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">y&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">dnf&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">releasever&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">8&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">allowerasing&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">setopt&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">deltarpm&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">false&lt;/span> &lt;span class="n">distro&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">sync&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">y&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">dnf&lt;/span> &lt;span class="n">groupupdate&lt;/span> &lt;span class="s2">&amp;#34;Core&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;Minimal Install&amp;#34;&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">y&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="升级到centos-stream-8">升级到Centos Stream 8
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">dnf install \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> http://mirror.centos.org/centos/8-stream/BaseOS/x86_64/os/Packages/centos-stream-repos-8-4.el8.noarch.rpm \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> http://mirror.centos.org/centos/8-stream/BaseOS/x86_64/os/Packages/centos-stream-release-8.6-1.el8.noarch.rpm \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> http://mirror.centos.org/centos/8-stream/BaseOS/x86_64/os/Packages/centos-gpg-keys-8-4.el8.noarch.rpm \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dnf distro-sync --allowerasing -y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="最后清理dnf-然后更新">最后清理dnf 然后更新
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">dnf clean packages
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">reboot
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="进入系统后-再更新一次">进入系统后 再更新一次
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">dnf update
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>后面还需要大量工作要处理，如果不是非常必要，建议直接重装&lt;/p></description></item><item><title>域名ssl和caa记录等知识记录整理</title><link>https://dev.leiyanhui.com/new/domian-ssl-caa/</link><pubDate>Sat, 22 Oct 2022 00:00:00 +0000</pubDate><guid>https://dev.leiyanhui.com/new/domian-ssl-caa/</guid><description>&lt;h1 id="域名ssl和caa记录等知识记录整理">域名ssl和caa记录等知识记录整理
&lt;/h1>&lt;h2 id="域名caa记录">域名CAA记录
&lt;/h2>&lt;p>简单的说 CAA记录 就是只允许域名从指定的 证书签发机构申请证书.&lt;/p>
&lt;p>作用 对日常操作来说 其实就是因为 签发机构可能会检查caa记录.&lt;/p>
&lt;p>理论上从2017年之后，所有证书签发机构都是要强制检查caa记录的，但是实际&amp;hellip;.&lt;/p>
&lt;p>从安全角度来说，就你可以限制，只有指定的 证书机构可以给你 域名颁发证书&lt;/p>
&lt;h2 id="caa记录作用域">CAA记录作用域
&lt;/h2>&lt;p>@ 作用到全局&lt;/p>
&lt;p>subdomain.leiyanhui.com 就只作用到subdomain.leiyanhui.com 这个域名 和这个域名的下级域&lt;/p>
&lt;p>但是部分签发机构会审核子域名的caa记录,就需要手动添加了&lt;/p>
&lt;h2 id="常用记录">常用记录
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">0 issue &amp;#34;trust-provider.com&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0 issue &amp;#34;letsencrypt.org&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">example.com. CAA 0 issue &amp;#34;quovadisglobal.com&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">example.com. CAA 0 issuewild &amp;#34;quovadisglobal.com&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">example.com. CAA 0 iodef &amp;#34;mailto:cert-admin@example.com&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>通知邮箱&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">0 iodef &amp;#34;mailto:joyanhui@qq.com&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="常用免费ssl证书">常用免费ssl证书
&lt;/h2>&lt;h3 id="letsencrypt">letsencrypt
&lt;/h3>&lt;p>可以简单用脚本续签，支持泛域名（有效期三个月） ，对老设备 旧浏览器 兼容性差一些&lt;/p>
&lt;p>续签是需要重新部署的哦.&lt;/p>
&lt;p>国内很多地方都可以在线申请,宝塔也内置了申请和自动续签,以及自动部署的脚本&lt;/p>
&lt;p>适合自有服务器环境，适合泛域名环境。github的pages 是使用他家的&lt;/p>
&lt;h3 id="digicert">DigiCert
&lt;/h3>&lt;p>阿里云可以申请 一个账号只可以申请20个，单一域名，有效期一年，对老设备 旧浏览器 兼容性几乎是最好的。
DigiCert 虽然很高大上,但是免费版现在好像没有用国内cdn了.&lt;/p>
&lt;p>申请网站：阿里云、华为云&lt;/p>
&lt;h3 id="trustasia">TrustAsia
&lt;/h3>&lt;p>TrustAsia 据说是DigiCert的代理商,免费版貌似也是没有国内cdn的&lt;/p>
&lt;p>自2022年03月03日22:00:00起，TrustAsia 根证书签发由 Digicert 根证书变更为 Sectigo 根证书。&lt;/p>
&lt;p>有效期1年，www.xxx.com 会送 xxx.com ，无法续签，重新申请。对老设备 旧浏览器 兼容性几乎是最好的。
部分网站支持 3个月的通配符 域名申请&lt;/p>
&lt;p>适合cdn用 自己记得每年重新申请就好。
腾讯云 一个账号 可以申请20个.
申请网站：腾讯云，又拍云，七牛云 &lt;a class="link" href="https://freessl.cn/" target="_blank" rel="noopener"
>https://freessl.cn/&lt;/a>&lt;/p>
&lt;h3 id="cloudflare">cloudflare
&lt;/h3>&lt;p>有效期15年, 只适合cf代理的站点,不怎么适合国内使用&lt;/p>
&lt;h3 id="sectigo">Sectigo
&lt;/h3>&lt;p>letsencrypt 一样 3个月，其他不明 没用过&lt;/p>
&lt;h2 id="同一个域名允许多个caa颁发机构">同一个域名允许多个caa颁发机构
&lt;/h2>&lt;p>重复添加多条记录就可以了. 一开始我以为用什么特殊符号分割的。实际不是&lt;/p>
&lt;h2 id="其他一些别名的问题">其他一些别名的问题
&lt;/h2>&lt;h3 id="子域名caa">子域名caa
&lt;/h3>&lt;p>部分厂商下发ssl 会同时检查 根域名和子域名的caa记录, 需要添加&lt;/p>
&lt;h3 id="cname-和-caa冲突的问题">cname 和 caa冲突的问题
&lt;/h3>&lt;p>先暂停cname记录,然后ping一下ip 获得ip后 添加A记录先&lt;/p>
&lt;p>然后添加对应记录的caa,然后申请,证书下发后,删除A记录 恢复 cname&lt;/p>
&lt;h2 id="相关资源">相关资源
&lt;/h2>&lt;p>通常在nginx 宝塔之类 环境下,我们用的都是 pem crt格式,如果部署到 iis tomcat 需要 PFX/PKCS jks 格式&lt;/p>
&lt;p>在线格式转化 &lt;code>https://www.sslaaa.com/tools/crt_to_jks&lt;/code>&lt;/p>
&lt;p>强烈建议自己转化。。。&lt;/p>
&lt;p>自动帮你生成记录值内容 &lt;code>https://sslmate.com/caa/&lt;/code>&lt;/p>
&lt;p>在线查询CAA记录值 &lt;code>https://www.myssl.cn/tools/caa.html&lt;/code>&lt;/p>
&lt;h2 id="常用caa记录">常用caa记录
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">SecureSite 0 issue &amp;#34;digicert.com&amp;#34; 0 issuewild &amp;#34;digicert.com&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">GeoTrust 0 issue &amp;#34;digicert.com&amp;#34; 0 issuewild &amp;#34;digicert.com&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TrustAsia 0 issue &amp;#34;trust-provider.com&amp;#34; 0 issuewild &amp;#34;trust-provider.com&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">GlobalSign 0 issue &amp;#34;globalsign.com&amp;#34; 0 issuewild &amp;#34;globalsign.com&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WoTrus 0 issue &amp;#34;wotrus.com&amp;#34; 0 issuewild &amp;#34; wotrus.com&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">DNSPod（国密标准（SM2）） 0 issue &amp;#34;wotrus.com&amp;#34; 0 issuewild &amp;#34; wotrus.com&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="推荐">推荐
&lt;/h2>&lt;p>dnspods 小泽的
&lt;code>https://r2wind.cn/articles/20221006.html&lt;/code>
&lt;code>https://r2wind.cn/articles/20220808.html&lt;/code>&lt;/p>
&lt;p>ssl详细查询&lt;/p>
&lt;p>&lt;a class="link" href="https://www.racent.com/ssl-check?domain=www.leiyanhui.com" target="_blank" rel="noopener"
>https://www.racent.com/ssl-check?domain=www.leiyanhui.com&lt;/a>&lt;/p></description></item><item><title>Linux 临时挂代理</title><link>https://dev.leiyanhui.com/new/linux-proxy/</link><pubDate>Tue, 18 Oct 2022 00:00:00 +0000</pubDate><guid>https://dev.leiyanhui.com/new/linux-proxy/</guid><description>&lt;h1 id="linux挂代理">Linux挂代理
&lt;/h1>&lt;h3 id="linux-临时挂代理">Linux 临时挂代理
&lt;/h3>&lt;p>&lt;!-- raw HTML omitted -->之前写过&lt;!-- raw HTML omitted -->&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">http_proxy&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;代理ip:代理端口&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">https_proxy&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;代理ip:代理端口&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>可以在 一个windows 或docker 上跑一个允许lan的clash 就好了&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">http_proxy&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;10.0.0.200:7890&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">https_proxy&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;10.0.0.200:7890&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>另外一个代理&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">http_proxy&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;10.0.0.9:7890&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">https_proxy&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;10.0.0.9:7890&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="临时取消代理">临时取消代理
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">unset http_proxy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">unset https_proxy
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="全局代理">全局代理
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">nano&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">profile&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">http_proxy&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;http://10.0.0.200:7890/&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">https_proxy&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;http://10.0.0.200:7890/&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">ftp_proxy&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;http://10.0.0.200:7890/&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">no_proxy&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;localhost,127.0.0.1,10.0.0.1/255.255.255.0,*.leiyanhui.com, ::1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">source&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">profile&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>nginx反代cf gitbook的502和403错误</title><link>https://dev.leiyanhui.com/new/nginx-proxy_pass-502/</link><pubDate>Tue, 18 Oct 2022 00:00:00 +0000</pubDate><guid>https://dev.leiyanhui.com/new/nginx-proxy_pass-502/</guid><description>&lt;h1 id="nginx反代cf-gitbook的502和403错误">nginx反代cf gitbook的502和403错误
&lt;/h1>&lt;p>需要手动编辑代理部分的配置文件,添加内容&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">proxy_ssl_name www.leiyanhui.com;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">proxy_ssl_server_name on;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>pve kvm 等usb 设备直通</title><link>https://dev.leiyanhui.com/new/kvm-usb/</link><pubDate>Tue, 18 Oct 2022 00:00:00 +0000</pubDate><guid>https://dev.leiyanhui.com/new/kvm-usb/</guid><description>&lt;h1 id="pve-kvm-等usb-设备直通">pve kvm 等usb 设备直通
&lt;/h1>&lt;p>需要注意是，pvm直通usb到虚拟机 常用的两种方式&lt;/p>
&lt;ul>
&lt;li>针对设备
无论设备插到那个端口都可以转到虚拟机，但是需要重启一次虚拟机才可以。&lt;/li>
&lt;li>针对usb口
指定的usb口分给虚拟机
要先插到usb口 再添加
针对usb3口，如果想usb2和usb3 都可以用 需要分别插入两种设备，逐个添加。否则不认识。&lt;/li>
&lt;/ul></description></item><item><title>kvm、pve、unraid 压缩磁盘</title><link>https://dev.leiyanhui.com/new/kvm-pve-unraid-compact-vdisk/</link><pubDate>Sun, 09 Oct 2022 00:00:00 +0000</pubDate><guid>https://dev.leiyanhui.com/new/kvm-pve-unraid-compact-vdisk/</guid><description>&lt;h1 id="kvmpveunraid-压缩磁盘">kvm、pve、unraid 压缩磁盘
&lt;/h1>&lt;p>pve虚拟的磁盘 在&lt;/p>
&lt;p>&lt;code>/var/lib/vz/images/102#&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">cd&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">vz&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">images&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">102&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ls&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">lh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">total&lt;/span> &lt;span class="mf">7.8&lt;/span>&lt;span class="n">G&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">-----&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">33&lt;/span>&lt;span class="n">G&lt;/span> &lt;span class="n">Oct&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">12&lt;/span> &lt;span class="n">vm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">102&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">disk&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">0.&lt;/span>&lt;span class="n">qcow2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#转化 就是压缩，但是并不会压缩太多，因为虚拟机内的操作系统删除的文件只是标识删除并没有写0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">qemu&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">img&lt;/span> &lt;span class="nb">convert&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">c&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">O&lt;/span> &lt;span class="n">qcow2&lt;/span> &lt;span class="n">vm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">102&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">disk&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">0.&lt;/span>&lt;span class="n">qcow2&lt;/span> &lt;span class="n">vm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">102&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">disk&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">compact&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">qcow2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="虚拟机机内部压缩虚拟磁盘">虚拟机机内部压缩虚拟磁盘
&lt;/h2>&lt;p>下面操作在虚拟机进行&lt;/p>
&lt;h3 id="linux虚拟主机">linux虚拟主机
&lt;/h3>&lt;h4 id="禁用swap并清零">禁用swap并清零
&lt;/h4>&lt;p>以archlinux为例&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">swapon -s partition 1010172 0 100
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>临时禁用 swap 文件并清零：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">swapoff /some/swap/file
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dd if=/dev/zero of=/some/swap/file bs=1M count=1024
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sync
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkswap /some/swap/file
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>我这个明显是分区，所以&lt;/p>
&lt;p>临时禁用 swap 分区并清零：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">swapoff /dev/zram0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dd if=/dev/zero of=/dev/zram0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sync
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkswap /dev/zram0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>提示 No space left on device 就是ok了&lt;/p>
&lt;p>清理缓存文件 arch 的主要是 pacman有一点&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pacman -Scc
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>fdisk -l 查看一下分区
df -h 查看挂载情况
然后用空白文件逐个填充,我这里 其实就一个分区&lt;/p>
&lt;p>sync 命令保证文件内容真正写到磁盘上而不是被缓存。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">dd if=/dev/zero of=/bigfile
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sync
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm /bigfile
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sync
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>另外一个centos7的主机&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">swapon -s # /www/swap /dev/dm-1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">swapoff /www/swap
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dd if=/dev/zero of=/www/swap bs=1M count=1024
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">swapoff /dev/dm-1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dd if=/dev/zero of=/dev/dm-1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sync
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dd if=/dev/zero of=/bigfile
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm /bigfile
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sync
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>关机&lt;/p>
&lt;h3 id="windows虚拟主机">windows虚拟主机
&lt;/h3>&lt;p>1、dism++ 删除多余的appx文件，清理
2、关闭虚拟内存 重启
3、磁盘整理，磁盘管理压缩分区
4、关机&lt;/p>
&lt;p>最后执行前面的 转化命令 就ok了&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">qemu-img convert -c -O qcow2 vm-102-disk-0.qcow2 vm-102-disk-0-compact.qcow2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp vm-102-disk-0-compact.qcow2 /mnt/hdd/kvm-bak/archlinux-vm-102-disk-0.qcow2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv vm-102-disk-0.qcow2 vm-102-disk-0.qcow2-bak
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv vm-102-disk-0-compact.qcow2 vm-102-disk-0.qcow2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>一个安装了 xrdp 搜狗输入法 微软全部字体 火狐 edge 和 kde完整桌面 以及一些基本工具的磁盘 大小 只有3.2G&lt;/p></description></item><item><title>pve unraid 等kvm手动安装黑苹果</title><link>https://dev.leiyanhui.com/new/pve-kvm-macos/</link><pubDate>Sun, 09 Oct 2022 00:00:00 +0000</pubDate><guid>https://dev.leiyanhui.com/new/pve-kvm-macos/</guid><description>&lt;h1 id="pve-unraid-等kvm手动安装黑苹果">pve unraid 等kvm手动安装黑苹果
&lt;/h1>&lt;p>本文迁移到 &lt;a class="link" href="../macos/kvm-macos-install.md" >pve unraid 等kvm手动安装黑苹果&lt;/a>&lt;/p></description></item><item><title>vhd转换给pve 并挂载给虚拟机</title><link>https://dev.leiyanhui.com/new/vhd-pve/</link><pubDate>Sat, 08 Oct 2022 00:00:00 +0000</pubDate><guid>https://dev.leiyanhui.com/new/vhd-pve/</guid><description>&lt;h1 id="vhd转换给pve-并挂载给虚拟机">vhd转换给pve 并挂载给虚拟机
&lt;/h1>&lt;p>&lt;code>find / -name vm-100-disk*&lt;/code>&lt;/p>
&lt;p>知道了路径 /var/lib/vz/images/100/&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#开始转换 hdd是机械盘，需要一点时间&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">qemu&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">img&lt;/span> &lt;span class="nb">convert&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">p&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">f&lt;/span> &lt;span class="n">vpc&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">O&lt;/span> &lt;span class="n">qcow2&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">mnt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">hdd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">vhd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">bak&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">SOFT&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">vhd&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">vz&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">images&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">soft&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">qcow2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>导入硬盘&lt;/p>
&lt;p>我这里导入给 100这个虚拟机&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#qm importdisk 300 /root/test.img local-lvm --format raw&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">qm&lt;/span> &lt;span class="n">importdisk&lt;/span> &lt;span class="mi">100&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">vz&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">images&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">soft&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">qcow2&lt;/span> &lt;span class="n">local&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">format&lt;/span> &lt;span class="n">qcow2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>上面的命令 会把 soft.qcow2 导入到 /var/lib/vz/images/100/vm-100-disk-3.qcow2 不是我想要的结果&lt;/p>
&lt;p>在pve面板中 添加一个虚拟磁盘，容量默认 VirtIO Block 也是在 /var/lib/vz/images/100/vm-100-disk-3.qcow2&lt;/p>
&lt;p>然后点分离,删除这个虚拟磁盘，然后做软连接&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">rm&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">vz&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">images&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">vm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">disk&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">3.&lt;/span>&lt;span class="n">qcow2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ln&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">vz&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">images&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">soft&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">qcow2&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">vz&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">images&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">vm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">disk&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">3.&lt;/span>&lt;span class="n">qcow2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>然后双击 未使用的磁盘 vm-100-disk-3.qcow2 添加一个虚拟磁盘 ，虚拟机中就可以看到了&lt;/p>
&lt;p>依次处理&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">qemu&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">img&lt;/span> &lt;span class="nb">convert&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">p&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">f&lt;/span> &lt;span class="n">vpc&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">O&lt;/span> &lt;span class="n">qcow2&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">mnt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">hdd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">vhd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">bak&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">Win&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Setup&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">vhd&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">mnt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">hdd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">vhd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">bak&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">Win&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Setup&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">qcow2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rm&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">vz&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">images&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">vm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">disk&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">4.&lt;/span>&lt;span class="n">qcow2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ln&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">mnt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">hdd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">vhd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">bak&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">Win&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Setup&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">qcow2&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">vz&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">images&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">vm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">disk&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">4.&lt;/span>&lt;span class="n">qcow2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>给 soft.qcow2 扩容一下&lt;/p>
&lt;p>先分离 最好直接关机 qm stop 100 #关机 开机状态弄 有概率无法分离或者损耗镜像 qemu-img resize /var/lib/vz/images/soft.qcow2 +10G&lt;/p></description></item><item><title>用vuepress和宝塔创建带搜索功能的静态文档站</title><link>https://dev.leiyanhui.com/new/vuepress-doc/</link><pubDate>Fri, 07 Oct 2022 00:00:00 +0000</pubDate><guid>https://dev.leiyanhui.com/new/vuepress-doc/</guid><description>&lt;h1 id="用vuepress和宝塔创建带搜索功能的静态文档站">用vuepress和宝塔创建带搜索功能的静态文档站
&lt;/h1>&lt;blockquote>
&lt;p>已经全部换到基于github的 hugo&lt;/p>&lt;/blockquote>
&lt;p>vuepress 官网的文档很全了不在说明&lt;/p>
&lt;p>我这里用 vuepress-theme-hope主题来搞&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">mkdir fish_doc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cd fish_doc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pnpm create vuepress-theme-hope@next docs
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>没有 pnpm的话先安装 pnpm&lt;/p>
&lt;p>可以选择中文，然后有一个博客主题 一个 docs主题，选择后者
最后一部 提示 是否查看 选 yes
打开
http://10.0.0.9:8080/&lt;/p>
&lt;p>基本搜索功能
/docs/src/.vuepress/config.ts
import { searchPlugin } from &amp;lsquo;@vuepress/plugin-search&amp;rsquo;&lt;/p>
&lt;p>searchPlugin({
&amp;lsquo;/&amp;rsquo;: {
placeholder: &amp;lsquo;搜索&amp;rsquo;,
isSearchable: (page) =&amp;gt; page.path !== &amp;lsquo;/&amp;rsquo;,
},
}),&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">import&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="n">defineUserConfig&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="n">from&lt;/span> &lt;span class="s2">&amp;#34;vuepress&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">import&lt;/span> &lt;span class="n">theme&lt;/span> &lt;span class="n">from&lt;/span> &lt;span class="s2">&amp;#34;./theme.js&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">import&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="n">searchPlugin&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="n">from&lt;/span> &lt;span class="s1">&amp;#39;@vuepress/plugin-search&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">default&lt;/span> &lt;span class="n">defineUserConfig&lt;/span>&lt;span class="p">({&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">base&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;/&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">title&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;xxx&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">description&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;just so so ..&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s2">&amp;#34;8902&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">theme&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">plugins&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">searchPlugin&lt;/span>&lt;span class="p">({&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;/&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">placeholder&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s1">&amp;#39;搜索&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">isSearchable&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">page&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">=&amp;gt;&lt;/span> &lt;span class="n">page&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">path&lt;/span> &lt;span class="o">!==&lt;/span> &lt;span class="s1">&amp;#39;/&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">shouldPrefetch&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="bp">false&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item></channel></rss>