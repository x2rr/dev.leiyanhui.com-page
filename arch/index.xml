<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Arches on 小类随手记</title><link>https://dev.leiyanhui.com/arch/</link><description>Recent content in Arches on 小类随手记</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Mon, 02 Jan 2023 09:40:20 +0800</lastBuildDate><atom:link href="https://dev.leiyanhui.com/arch/index.xml" rel="self" type="application/rss+xml"/><item><title>archlinux 各种桌面环境下的xrdp的配置</title><link>https://dev.leiyanhui.com/arch/xrdp-all/</link><pubDate>Mon, 02 Jan 2023 09:40:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/xrdp-all/</guid><description>&lt;p>xrdp 相对 vnc 以及第三方的其他的原创桌面的软件 例如 todesk rustdesk（自建） nomactione 以及 串流等，都有速度优势。&lt;/p>
&lt;p>但是xrdp 肯定是只支持x11/xorg的，目前只有gnome自带的远程（用户级且不稳定）支持Wayland&lt;/p>
&lt;p>在不同桌面的下 xrdp的处理也稍有差异，这里分别记录常见的&lt;/p>
&lt;h2 id="安装配置xrdp">安装配置xrdp
&lt;/h2>&lt;p>这里跳过桌面环境的搭建 kde、i3、xfce4 ，以及驱动部分，只记录xrdp相关的&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S xorg-xinit # 一般桌面应该都带了
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S base-devel #all 一些编译要用的包
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yay -S xrdp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yay -S xorgxrdp-glamor
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S xorg-xrdb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>声卡的处理要用pulseaudio&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S pulseaudio
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S sbc bluez
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yay -S pulseaudio-module-xrdp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="处理启动脚本">处理启动脚本
&lt;/h2>&lt;p>xrdp 使用xinit 启动&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cp /etc/X11/xinit/xinitrc ~/.xinitrc #复制一个过来
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nano ~/.xinitrc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#注释掉最后的几行
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#twm &amp;amp;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#xclock -geometry 50x50-1+1 &amp;amp;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#xterm -geometry 80x50+494+51 &amp;amp;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#xterm -geometry 80x20+494-0 &amp;amp;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#exec xterm -geometry 80x66+0+0 -name login
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="pulseaudio">pulseaudio
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># 声音部分可能需要 有的桌面环境不需要
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PULSE_SCRIPT=/etc/xrdp/pulse/default.pa pulseaudio --daemonize=no
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pulseaudio &amp;amp;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="添加需要启动的桌面">添加需要启动的桌面
&lt;/h3>&lt;h4 id="i3w--dwm">i3w / dwm
&lt;/h4>&lt;p>添加一行&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">exec i3w
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="gnome">gnome
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">unset SESSION_MANAGER
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">unset DBUS_SESSION_BUS_ADDRESS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">exec dbus-launch gnome-shell --x11
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="kde">kde
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">DESKTOP_SESSION&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">plasma&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">plasma&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">dbus&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">run&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">session&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">needed&lt;/span> &lt;span class="n">startplasma&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">x11&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="xfce4">xfce4
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">unset SESSION_MANAGER
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">unset DBUS_SESSION_BUS_ADDRESS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">exec dbus-launch startxfce4
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="后续处理">后续处理
&lt;/h2>&lt;h3 id="xwrapper">Xwrapper
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo nano /etc/X11/Xwrapper.config
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">allowed_users=anybody
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="启动xrdp">启动xrdp
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo systemctl enable xrdp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl start xrdp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>arhclinux 下开机按照顺序挂载磁盘和启动docker以及kvm</title><link>https://dev.leiyanhui.com/arch/auto-mount-dock-kvm/</link><pubDate>Thu, 29 Dec 2022 18:15:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/auto-mount-dock-kvm/</guid><description>&lt;h2 id="先禁止docker和kvmlibvirtd开机自动">先禁止docker和kvm(libvirtd)开机自动
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">systemctl disable docker
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl disable libvirtd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="自定义一个开机服务rc-local">自定义一个开机服务rc-local
&lt;/h2>&lt;h3 id="rc-localservic">rc-local.servic
&lt;/h3>&lt;p>&lt;code>nano /usr/lib/systemd/system/rc-local.service&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[Unit]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Description=&amp;#34;/etc/rc.local Compatibility&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[Service]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Type=forking
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ExecStart=/etc/rc.local start
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TimeoutSec=0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">StandardInput=tty
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">RemainAfterExit=yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SysVStartPriority=99
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[Install]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WantedBy=multi-user.target
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="rclocal">rc.local
&lt;/h3>&lt;p>&lt;code>nano /etc/rc.local&lt;/code> 查找/etc/rc.local.d/下的脚本并执行&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/sh
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="c1"># /etc/rc.local&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="nb">test&lt;/span> -d /etc/rc.local.d&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> rcscript in /etc/rc.local.d/*.sh&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">test&lt;/span> -r &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">rcscript&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> sh &lt;span class="si">${&lt;/span>&lt;span class="nv">rcscript&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">unset&lt;/span> rcscript
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="权限-目录-和开机自启">权限 目录 和开机自启
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">chmod a+x /etc/rc.local
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkdir /etc/rc.local.d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl enable rc-local
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="创建自动脚本">创建自动脚本
&lt;/h3>&lt;p>&lt;code>sudo nano /etc/rc.local.d/auto-mount-and-start-aio.sh&lt;/code>&lt;/p>
&lt;p>内容如下&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># 自动挂载
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#mkdir-p mnt/nvme mnt/efi mnt/exfat
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mount /dev/nvme0n1p6 /home/yanhui/mnt/exfat
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mount /dev/nvme0n1p5 /home/yanhui/mnt/nvme
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mount /dev/nvme0n1p1 /home/yanhui/mnt/efi
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="docker-和kvm的迁移">docker 和kvm的迁移
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">systemctl&lt;/span> &lt;span class="n">stop&lt;/span> &lt;span class="n">docker&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rsync&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">avzP&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">docker&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">yanhui&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">mnt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nvme&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">mv&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">docker&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">docker&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">bak&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="n">ln&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">yanhui&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">mnt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nvme&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">docker&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 完成后 rm -rf /var/lib/docker.bak&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">systemctl&lt;/span> &lt;span class="n">stop&lt;/span> &lt;span class="n">libvirtd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rsync&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">avzP&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">libvirt&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">yanhui&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">mnt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nvme&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">mv&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">libvirt&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">libvirt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">bak&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="n">ln&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">yanhui&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">mnt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nvme&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">libvirt&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 完成后 rm -rf /var/lib/libvirt.bak&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="修改docker和libvirtd服务启动顺序">修改docker和libvirtd服务启动顺序
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd /usr/lib/systemd/system/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>分别编辑 &lt;code>sudo nano libvirtd.service&lt;/code> 和 &lt;code>sudo nano docker.service&lt;/code> 在&lt;code>[Unit]&lt;/code> 段 增加一行&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">After=rc-local.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这行是为了让docker和libvirtd 在rc-local这个服务之后启动，方便我们在 rc-local 内先挂载好磁盘
最后这两个服务设置为自动启动&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo systemctl enable libvirtd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl enable docker
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl start docker
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl start libvirtd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="另一个文章">另一个文章
&lt;/h3>&lt;p>&lt;a class="link" href="https://dev.leiyanhui.com/arch/auto--dock-kvm/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/arch/auto&amp;ndash;dock-kvm/&lt;/a>&lt;/p></description></item><item><title>基于ventoy启动的linux虚拟磁盘的扩容</title><link>https://dev.leiyanhui.com/arch/ventoy-vdisk-resize/</link><pubDate>Thu, 29 Dec 2022 06:14:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/ventoy-vdisk-resize/</guid><description>&lt;p>这里以 archlinux 和 vhd格式 为例，raw格式 可以用qemu-img 扩容。&lt;/p>
&lt;p>一个可以正常启动的linux镜像&lt;code>archinstall-ext4.vhd.vtoy&lt;/code> 如果不会弄，参考：https://dev.leiyanhui.com/arch/boot-vhd-ventoy/&lt;/p>
&lt;blockquote>
&lt;p>ventoy启动的linux 扩容比较麻烦&lt;/p>&lt;/blockquote>
&lt;h2 id="虚拟磁盘扩容">虚拟磁盘扩容
&lt;/h2>&lt;p>先关掉系统，然后重启到另外一个带虚拟机的系统，linux 或者win 都可以
linux下 建议用qemu-img 转换到ram后扩容 过程掠过&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">mv archinstall-ext4.vhd.vtoy archinstall-ext4.vhd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pacman -S qemu-img
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># vpc 是vhd格式
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">qemu-img convert -p -f vpc -O raw archinstall-ext4.vhd archinstall-ext4.raw
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">qemu-img resize archinstall-ext4.raw +5G
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv archinstall-ext4.raw archinstall-ext4.raw.vtoy
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>win下 可以直接使用diskpart 或者 第三方工具扩容。比如&lt;code>Bootice.exe&lt;/code> 一般pe都有，在磁盘信息的地方输入新容量即可&lt;/p>
&lt;blockquote>
&lt;p>缩小镜像，会导致不可以预料的文件丢失 ，轻易不要尝试&lt;/p>&lt;/blockquote>
&lt;h2 id="新虚拟磁盘文件挂载到虚拟机">新虚拟磁盘文件挂载到虚拟机
&lt;/h2>&lt;p>可以用virtualbox或者kvm,root用户登录&lt;/p>
&lt;h2 id="在系统内部处理">在系统内部处理
&lt;/h2>&lt;p>用ventoy启动扩容好的虚拟磁盘系统，ssh登录&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cfdisk /dev/sdXXX
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>resize需要处理的分区，我这里是/dev/sda2，然后write写入 yes确认 退出&lt;/p>
&lt;h3 id="ext4-格式">ext4 格式
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">resize2fs /dev/sdXXX
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="btrfs格式-操作根目录">btrfs格式 操作根目录
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">btrfs filesystem resize max /
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="然后重新执行vtoyboot">然后重新执行vtoyboot
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd /root/vtoyboot*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sh vtoyboot.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="准备重启">准备重启
&lt;/h2>&lt;p>虚拟磁盘文件重命名为 XX.vtoy ，重新用ventoy引导 完毕。&lt;/p></description></item><item><title>archlinux 打开x11转发</title><link>https://dev.leiyanhui.com/arch/x11-forwarding/</link><pubDate>Wed, 28 Dec 2022 15:20:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/x11-forwarding/</guid><description>&lt;p>arch 的一个家庭server上启用 x11 转发 方便应急的情况下用浏览器备份文件到网页端网盘&lt;/p>
&lt;p>本文基于 &lt;code>Linux archlinux 6.1.1-zen1-1-zen &lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S xorg-xauth
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo nano /etc/ssh/sshd_config
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>sshd_config&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">X11Forwarding yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">X11DisplayOffset 10
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">X11UseLocalhost yes
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>重启sshd 重新链接 ok了&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo systemctl restart sshd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&amp;mdash;&amp;mdash; 下面内容作废 &amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;ndash;
修改 sshd_config&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo nano /etc/ssh/sshd_config
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">----下面几行取消#注释---
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#AllowAgentForwarding yes #非必须
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#AllowTcpForwarding yes #非必须
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#X11Forwarding no #取消注释并改为yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#X11DisplayOffset 10
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#X11UseLocalhost yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#AddressFamily any # 这项下面添加一行 AddressFamily inet
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>重启ssh后 发现无效 查询wiki后发现需要 xorg-xauth
安装xorg-xauth&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S xorg-xauth
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>配置&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">touch ~/.Xauthority &amp;amp;&amp;amp; chmod 600 ~/.Xauthority
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>重启sshd&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo systemctl restart sshd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>重新链接 ok了&lt;/p>
&lt;p>参考 &lt;a class="link" href="https://wiki.archlinuxcn.org/wiki/OpenSSH#X11_forwarding" target="_blank" rel="noopener"
>https://wiki.archlinuxcn.org/wiki/OpenSSH#X11_forwarding&lt;/a>&lt;/p></description></item><item><title>archlinux运行kvm all in one主机，包括核显和pci直通 保姆级教程 新版</title><link>https://dev.leiyanhui.com/arch/install-kvm/</link><pubDate>Wed, 28 Dec 2022 14:00:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/install-kvm/</guid><description>&lt;p>本文旧版：https://dev.leiyanhui.com/kvm/archlinux-kvm/&lt;/p>
&lt;h3 id="配置基本的宿主系统">配置基本的宿主系统
&lt;/h3>&lt;p>手动安装arch &lt;a class="link" href="https://dev.leiyanhui.com/arch/base-install/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/arch/base-install/&lt;/a>&lt;/p>
&lt;h4 id="可选操作">可选操作
&lt;/h4>&lt;p>最小化安装gnome &lt;a class="link" href="https://dev.leiyanhui.com/arch/arch-linux-install-gnome-desktop/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/arch/arch-linux-install-gnome-desktop/&lt;/a>
gnome 的远程桌面 好像有一些问题 基于安全还需要配置 证书之类的麻烦。。而且xrdp性能比rdp差太多了。
我这里用rustdesk
安装rustdesk远程控制 &lt;a class="link" href="https://dev.leiyanhui.com/arch/rustdesk/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/arch/rustdesk/&lt;/a>&lt;/p>
&lt;p>禁用wayland（安装rustdesk 只支持xorg）：https://rustdesk.com/docs/en/manual/linux/#login-screen
或者 不要桌面，直接用x11转发 &lt;a class="link" href="https://dev.leiyanhui.com/arch/x11-forwarding/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/arch/x11-forwarding/&lt;/a>&lt;/p>
&lt;h3 id="配置kvm">配置kvm
&lt;/h3>&lt;h4 id="qemu-base">qemu-base
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S qemu-base
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;blockquote>
&lt;p>现在kvm 已经可以用了，但是&amp;hellip;只能用命令行，而且还有一些权限问题需要处理。 我这里打算直接用图形界面，所以继续处理。&lt;/p>&lt;/blockquote>
&lt;h4 id="其他支持">其他支持
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S samba dnsmasq dmidecode
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S iptables-nft bridge-utils openbsd-netcat
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="客户端选择">客户端选择
&lt;/h4>&lt;p>aqemu 有一点问题，我这里选 libvirt + virt-manager&lt;/p>
&lt;h5 id="libvirt">libvirt
&lt;/h5>&lt;blockquote>
&lt;p>virsh 是用于管理和配置域（虚拟机）的命令行程序。 就是支持 xml管理kvm虚拟机了一个基本程序&lt;/p>&lt;/blockquote>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S libvirt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>处理权限相关&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo groupadd libvirt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo usermod -a -G libvirt $USER
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>配置 &lt;code>sudo nano /etc/libvirt/libvirtd.conf&lt;/code>
找到&lt;code>#unix_sock_group = &amp;quot;libvirt&amp;quot;&lt;/code> 取消注册&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo systemctl enable libvirtd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl start libvirtd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl status libvirtd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="ui-客户端">ui 客户端
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S virt-manager
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>virt-manager 是一个功能强大virsh的ui客户端&lt;/p>
&lt;p>virt-manager 链接的时候 记得选择 用户级的 qemu:///session&lt;/p>
&lt;h2 id="其他软件">其他软件
&lt;/h2>&lt;p>安装浏览器 和文件管理工具&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S firefox wqy-zenhei
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S thunar
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>建议用appimage&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">sudo&lt;/span> &lt;span class="n">pacman&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">S&lt;/span> &lt;span class="n">fuse&lt;/span> &lt;span class="c1">#AppImage 依赖&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">sudo&lt;/span> &lt;span class="n">pacman&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">S&lt;/span> &lt;span class="n">dbus&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">glib&lt;/span> &lt;span class="c1"># 火狐依赖&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">wget&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">apprepo&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">de&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">appimage&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">download&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">firefox&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">document&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">Firefox&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">AppImage&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">chmod&lt;/span> &lt;span class="o">+&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">./*.&lt;/span>&lt;span class="n">AppImage&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">./&lt;/span>&lt;span class="n">Firefox&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">AppImage&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>linux搭建串流服务器 玩游戏 刷视频，客户端支持 ios 安卓 win linux macos等</title><link>https://dev.leiyanhui.com/arch/moonlight-sunshine-install/</link><pubDate>Tue, 27 Dec 2022 09:25:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/moonlight-sunshine-install/</guid><description>&lt;p>archlinux 作为服务端，客户端我用的win上网本。 在10M的带宽上 可以系统1080p 30帧的 流畅体验，办公没有任何压力，游戏的话体验就差一点。60帧要20M&lt;/p>
&lt;h2 id="显卡驱动">显卡驱动
&lt;/h2>&lt;p>我这里是核显 intel uhd630&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S vulkan-intel
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="服务端安装sunshine">服务端安装sunshine
&lt;/h2>&lt;p>有很多安装方法，我这里用aur的 简单一些&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">yay -S sunshine
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="服务器端处理">服务器端处理
&lt;/h2>&lt;p>依赖&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S fuse
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>用户权限&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo usermod -a -G input $USER
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>udev 规则&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">echo &amp;#39;KERNEL==&amp;#34;uinput&amp;#34;, GROUP=&amp;#34;input&amp;#34;, MODE=&amp;#34;0660&amp;#34;, OPTIONS+=&amp;#34;static_node=uinput&amp;#34;&amp;#39; | \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo tee /etc/udev/rules.d/85-sunshine-input.rules
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>KMS 的额外设置&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo setcap cap_sys_admin+p $(readlink -f $(which sunshine))
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>用户服务&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">mkdir -p ~/.config/systemd/user/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nano ~/.config/systemd/user/sunshine.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[Unit]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Description=Sunshine Gamestream Server for Moonlight
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[Service]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ExecStart=/usr/bin/sunshine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#Flatpak Only
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#ExecStop=flatpak kill dev.lizardbyte.sunshine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[Install]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WantedBy=graphical-session.target
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>启动&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">systemctl --user enable sunshine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl --user start sunshine
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>重启服务器，使用x11 登录桌面，我这里是kde （要无人职守的话，需要配置自动登录）&lt;/p>
&lt;p>打开 https://IP:47990/ 配置帐号密码，并配置好帐号密码。&lt;/p>
&lt;p>客户端下载，我这里是 windows&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/moonlight-stream/moonlight-qt/releases" target="_blank" rel="noopener"
>https://github.com/moonlight-stream/moonlight-qt/releases&lt;/a>&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/moonlight-stream/moonlight-qt/releases/download/v4.3.1/MoonlightPortable-x64-4.3.1.zip" target="_blank" rel="noopener"
>https://github.com/moonlight-stream/moonlight-qt/releases/download/v4.3.1/MoonlightPortable-x64-4.3.1.zip&lt;/a>&lt;/p>
&lt;p>解压 运行，&lt;/p>
&lt;p>链接 linux的ip ，让输入pin数字，在网页端 https://IP:47990/ 点pin 输入，然后客户端等一下自动链接上 点击desktop 完毕&lt;/p>
&lt;p>推出快捷键是 ctl alt shift Q&lt;/p>
&lt;p>鼠标灵敏度问题，需要两边设置分辨率一样 就ok了&lt;/p></description></item><item><title>linux下gnome自动登录后密钥环的问题</title><link>https://dev.leiyanhui.com/arch/gnome-key-err/</link><pubDate>Mon, 26 Dec 2022 09:58:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/gnome-key-err/</guid><description>&lt;p>gnome的密钥环不能跟随自动登录自动解锁，会导致一些使用的问题。例如 gnome自带的xrdp无法链接。 需要手动解锁一次&lt;/p>
&lt;p>简单的处理，直接删除所有&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">rm ~/.local/share/keyrings/login.keyring
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>点击需要密钥环的地方（例如共享），或者安装并启动seahorse&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pacman -S seahorse
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>提示选择新密钥环，让输入密码的时候，密码留空&lt;/p></description></item><item><title>archLinux 下显卡驱动相关整理 intel amd Nvidia 包括虚拟机的</title><link>https://dev.leiyanhui.com/arch/gpu-drvi/</link><pubDate>Mon, 19 Dec 2022 09:25:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/gpu-drvi/</guid><description>&lt;h2 id="mesa">mesa
&lt;/h2>&lt;p>sudo pacman -S mesa
它提供用于3D加速的基础DRI驱动程序。&lt;/p>
&lt;h2 id="虚拟机下的显卡驱动">虚拟机下的显卡驱动
&lt;/h2>&lt;p>虚拟机的情况，有很多中，常用的 vmware 和 virio gpu&lt;/p>
&lt;h3 id="virio-gpu">virio gpu
&lt;/h3>&lt;p>需要手动 编译mesa&lt;/p>
&lt;h3 id="vmware--virtual-box">vmware / virtual box
&lt;/h3>&lt;pre>&lt;code>sudo pacman -S xf86-video-vmware
&lt;/code>&lt;/pre>
&lt;h2 id="intel核显">intel核显
&lt;/h2>&lt;pre>&lt;code>sudo pacman -S xf86-video-intel
&lt;/code>&lt;/pre>
&lt;p>Ivy Bridge及以上架构的cpu 只安装vulkan-intel 也可以&lt;/p>
&lt;h2 id="nvidia">Nvidia
&lt;/h2>&lt;pre>&lt;code>sudo pacman -S nvidia nvidia-prime nvidia-settings nvidia-utils opencl-nvidia lib32-nvidia-utils lib32-opencl-nvidia
&lt;/code>&lt;/pre>
&lt;p>nvidia驱动非开源的 可能需要&lt;code>/etc/pacman.conf&lt;/code>打开 multilib 仓库
另外可能需要&lt;/p>
&lt;pre>&lt;code>sudo pacman -S xf86-video-nouveau
&lt;/code>&lt;/pre></description></item><item><title>archLinux 切换到cachyos发行版</title><link>https://dev.leiyanhui.com/arch/arch-to-cachyos/</link><pubDate>Sun, 11 Dec 2022 20:25:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/arch-to-cachyos/</guid><description>&lt;p>cachyos是基于arch的一个发行版，有点是带x86_64_v3 的一个仓库。 可以提升10%的cpu性能。
并且可以和arch的仓库混用。&lt;/p>
&lt;h2 id="准备切换-就备份一下">准备切换 ，就备份一下
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo cp /etc/pacman.conf /etc/pacman.conf-bak-before-cachyos
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="直接用官网包处理源">直接用官网包处理源
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">wget https://mirror.cachyos.org/cachyos-repo.tar.xz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tar xvf cachyos-repo.tar.xz &amp;amp;&amp;amp; cd cachyos-repo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo ./cachyos-repo.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="实际修改后的文件多了一段">实际修改后的文件多了一段
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[cachyos-v3]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Include = /etc/pacman.d/cachyos-v3-mirrorlist
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="更新">更新
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -Syyu
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>会把你已经装过的替换为v3版&lt;/p>
&lt;h3 id="更换内核">更换内核
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S linux-cachyos-pds-lto
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="配置引导">配置引导
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo nano /etc/default/grub
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---添加或者修改三行-方便引导的时候选择内核
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">GRUB_DISABLE_SUBMENU=y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">GRUB_DEFAULT=saved
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">GRUB_SAVEDEFAULT=true
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="更新引导-然后重启-选择新装的内核pds">更新引导 然后重启 选择新装的内核pds
&lt;/h4>&lt;p>&lt;code>sudo grub-mkconfig -o /boot/grub/grub.cfg&lt;/code>&lt;/p>
&lt;h4 id="卸载旧内核清理">卸载旧内核清理
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -Rns linux
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo grub-mkconfig -o /boot/grub/grub.cfg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yay -Sccc
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>i3w 常用快捷键和基本配置</title><link>https://dev.leiyanhui.com/arch/i3w-config-key/</link><pubDate>Sun, 11 Dec 2022 08:23:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/i3w-config-key/</guid><description>&lt;h2 id="简单说明">简单说明
&lt;/h2>&lt;p>i3w 不单 可以多个屏幕，还可以多组windows，甚至可以存在 父组 子组等。&lt;/p>
&lt;h2 id="常用快捷键">常用快捷键
&lt;/h2>&lt;p>$mod + Enter 启动虚拟终端&lt;br>
$mod + A 焦点转义到父窗口上&lt;br>
$mod + S 堆叠布局&lt;br>
$mod + W 标签布局&lt;br>
$mod + E 默认布局 连续按下 可以从 纵向排列和竖向排列之间 来回切换&lt;br>
$mod + SpaceBar 焦点在平铺式／浮动式转换&lt;br>
$mod + Shift + SpaceBar 窗口在平铺式／浮动式转换&lt;br>
$mod + shift + &amp;lt;数字键&amp;gt; 将当前程序发送到指定window&lt;br>
$mod + &amp;lt;方向键&amp;gt; 移动鼠标到焦点&lt;br>
$mod + shift + &amp;lt;方向键&amp;gt; 移动窗口位置&lt;br>
$mod + D 启动 dmenu&lt;br>
$mod + H 水平分割窗口&lt;br>
$mod + V 垂直分割窗口&lt;br>
$mod + J 焦点往左窗口移&lt;br>
$mod + K 焦点往下窗口移&lt;br>
$mod + L 焦点往上窗口移&lt;br>
$mod + ; 焦点往右窗口移&lt;br>
$mod + Shift + Q 杀死当前窗口的进程&lt;br>
$mod + Shift + E 退出 i3&lt;br>
$mod + Shift + C 当场重新加载 i3config, 无需重启&lt;br>
$mod + Shift + R 重启 i3 （还重新加载了 i3config, 又没有退出过程）&lt;br>
$mod + Shift + J 窗口左移 等同于 $mod + shift + &amp;lt;方向键&amp;gt;&lt;br>
$mod + Shift + K 窗口下移 等同于 $mod + shift + &amp;lt;方向键&amp;gt;&lt;br>
$mod + Shift + L 窗口上移 等同于 $mod + shift + &amp;lt;方向键&amp;gt;&lt;br>
$mod + Shift + : 窗口右移 等同于 $mod + shift + &amp;lt;方向键&amp;gt;&lt;br>
$mod + &amp;lt;数字键&amp;gt; 切换window&lt;br>
$mod + F 焦点窗口全屏&lt;/p></description></item><item><title>linux下git备份home目录到远程仓库</title><link>https://dev.leiyanhui.com/arch/git-backup-userdir/</link><pubDate>Sun, 11 Dec 2022 07:25:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/git-backup-userdir/</guid><description>&lt;p>在/home/用户名 这个目录下存放着我们的大量配置文件。尤其是系统的一些配置i，还有一些个别软件的配置。&lt;/p>
&lt;h2 id="先创建远程私有库和token-key">先创建远程私有库和token key
&lt;/h2>&lt;p>过程略&lt;/p>
&lt;h2 id="配置过滤文件-gitignore">配置过滤文件 .gitignore
&lt;/h2>&lt;p>.gitignore&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 修改后需要执行下面命令清理缓存&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># git rm -r --cached .&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/.&lt;/span>&lt;span class="n">cache&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="n">Downloads&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="err">下载&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/.&lt;/span>&lt;span class="n">mozilla&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/.&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">electronic&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">wechat&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/.&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">icalingua&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/.&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">QQ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/.&lt;/span>&lt;span class="n">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">logs&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="n">golang&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">webdavgo&lt;/span>&lt;span class="o">/.&lt;/span>&lt;span class="n">git&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="n">golang&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">webdavgo&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/.&lt;/span>&lt;span class="n">gocache&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="n">golang&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">ole&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/.&lt;/span>&lt;span class="n">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">code&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">logs&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">vscode&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">lock&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">code&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">stdout&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">log&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/.&lt;/span>&lt;span class="n">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">fish&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">fish_history&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="处理git-这样嗯里-gitsh">处理git 这样嗯里 git.sh
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 定义源 git remote set-url origin https://joyanhui:XXX@github.com/joyanhui/XXXX.git&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 修改 .gitignore 后需要清理缓存&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#git init&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#git rm -r --cached .&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">git&lt;/span> &lt;span class="n">add&lt;/span> &lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">git&lt;/span> &lt;span class="n">commit&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">m&lt;/span> &lt;span class="s2">&amp;#34;sh git.sh 自动 $(date &amp;#34;&lt;/span>&lt;span class="o">+%&lt;/span>&lt;span class="n">Y&lt;/span>&lt;span class="o">-%&lt;/span>&lt;span class="n">m&lt;/span>&lt;span class="o">-%&lt;/span>&lt;span class="n">d&lt;/span> &lt;span class="o">%&lt;/span>&lt;span class="n">H&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="n">M&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="n">S&lt;/span>&lt;span class="s2">&amp;#34;) -$RANDOM&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 挂代理&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">http_proxy&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;10.0.0.1:20172&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">https_proxy&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;10.0.0.1:20172&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># git remote add origin https://joyanhui:XXX@github.com/joyanhui/XXXX.git&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># git remote set-url origin https://joyanhui:XXX@github.com/joyanhui/XXXX.git&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># git pull --rebase origin master&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 强制覆盖 git push -f origin master&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">git&lt;/span> &lt;span class="n">push&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">u&lt;/span> &lt;span class="n">origin&lt;/span> &lt;span class="n">master&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>archLinux ibus</title><link>https://dev.leiyanhui.com/arch/ibus-install/</link><pubDate>Thu, 08 Dec 2022 08:02:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/ibus-install/</guid><description>&lt;h2 id="安裝-ibus-基础">安裝 ibus 基础
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S ibus
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="安装一个输入法引擎">安装一个输入法引擎
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S ibus-rime # ibus-libpinyin ibus-pinyin
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="启动">启动
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">ibus-daemon -d -x
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="配置">配置
&lt;/h2>&lt;p>右键ibus托盘，简单配置。
rime的话，直接打开输入框（第一次启动有一些延迟） 然后点F4 选择简体&lt;/p>
&lt;h2 id="和其他软件的通讯">和其他软件的通讯
&lt;/h2>&lt;p>多数软件可以使用，部分软件,最好加到 ~/.pam_environment&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">GTK_IM_MODULE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">ibus&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">XMODIFIERS&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">im&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">ibus&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">QT_IM_MODULE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">ibus&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ibus&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">daemon&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">d&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">x&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>arch linux最小化安装gnome</title><link>https://dev.leiyanhui.com/arch/arch-linux-install-gnome-desktop/</link><pubDate>Wed, 07 Dec 2022 09:58:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/arch-linux-install-gnome-desktop/</guid><description>&lt;p>现在用的i3w，准备安装一个gnome 一起使用，从头开始弄&lt;/p>
&lt;h2 id="手动安装最基本的archlinux">手动安装最基本的archlinux
&lt;/h2>&lt;p>&lt;a class="link" href="https://dev.leiyanhui.com/arch/base-install/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/arch/base-install/&lt;/a>&lt;/p>
&lt;h2 id="安装xorg和显卡驱动之类的">安装xorg和显卡驱动之类的
&lt;/h2>&lt;pre>&lt;code>pacman -S linux-firmware xf86-video-vesa
&lt;/code>&lt;/pre>
&lt;h2 id="xorg-server">xorg-server
&lt;/h2>&lt;pre>&lt;code>sudo pacman -S --needed xorg-server
&lt;/code>&lt;/pre>
&lt;h2 id="gnome-shell">gnome-shell
&lt;/h2>&lt;pre>&lt;code>sudo pacman -S gnome-shell
&lt;/code>&lt;/pre>
&lt;p>解压后300M+&lt;/p>
&lt;h2 id="其他可能需要的gnome-组件">其他可能需要的gnome 组件
&lt;/h2>&lt;h3 id="设置组件">设置组件
&lt;/h3>&lt;pre>&lt;code>sudo pacman -S gnome-control-center
&lt;/code>&lt;/pre>
&lt;p>解压后130M，包括壁纸设置 分辨率 屏幕方向 等等&lt;/p>
&lt;h3 id="配置中文">配置中文
&lt;/h3>&lt;pre>&lt;code>sudo nano /etc/locale.gen
------
en_US.UTF-8 UTF-8
zh_CN.UTF-8 UTF-8
zh_SG.UTF-8 UTF-8
&lt;/code>&lt;/pre>
&lt;h3 id="主题和扩展">主题和扩展
&lt;/h3>&lt;pre>&lt;code>sudo pacman -S gnome-themes-extra
yay -S chrome-gnome-shell
火狐打开 https://extensions.gnome.org/ 按照提示安装扩展
&lt;/code>&lt;/pre>
&lt;p>比如 dock from dash ，固定dock&lt;/p>
&lt;h3 id="卸载">卸载
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -Rns gnome-themes-extra chrome-gnome-shell gnome-control-center gnome-shell
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="中文字体">中文字体
&lt;/h3>&lt;p>自己选一个，我还是喜欢雅黑。。&lt;/p>
&lt;h3 id="输入法">输入法
&lt;/h3>&lt;pre>&lt;code>sudo pacman -S ibus-rime
&lt;/code>&lt;/pre>
&lt;h2 id="安装登录管理器">安装登录管理器
&lt;/h2>&lt;p>可以用 xorg-xinit ，但是我这里需要用rustdesk 所以选 lightdm&lt;/p>
&lt;pre>&lt;code>sudo pacman -S lightdm-gtk-greeter
sudo systemctl enable lightdm
sudo systemctl start lightdm
&lt;/code>&lt;/pre>
&lt;h2 id="其他">其他
&lt;/h2>&lt;h3 id="应用软件">应用软件
&lt;/h3>&lt;p>自己喜欢的文件管理器和终端 文本编辑器等尽量和i3w 复用&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S thunar xed terminator
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>QQ linux 新版终于发布啦</title><link>https://dev.leiyanhui.com/arch/new-qq2022/</link><pubDate>Wed, 07 Dec 2022 09:58:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/new-qq2022/</guid><description>&lt;p>qq终于更新linux版本啦。 虽然不出所料是electron版，但是总算是更新啦&amp;hellip;&lt;/p>
&lt;h2 id="内测群消息">内测群消息
&lt;/h2>&lt;p>2022-12-07 09:47&lt;/p>
&lt;p>&lt;a class="link" href="https://dldir1.qq.com/qqfile/qq/QQNT/4691a571/QQ-v2.0.1-429_x64.AppImage" target="_blank" rel="noopener"
>https://dldir1.qq.com/qqfile/qq/QQNT/4691a571/QQ-v2.0.1-429_x64.AppImage&lt;/a>&lt;/p>
&lt;p>#Linux QQ 全新来袭#时隔3年，Linux QQ基于NT架构全新升级啦&lt;/p>
&lt;p>[庆祝]12月7日起，正式开启公测，期待收到大家反馈的声音关于体验方式点击下方链接，即刻“尝鲜”&lt;/p>
&lt;p>&lt;a class="link" href="https://dldir1.qq.com/qqfile/qq/QQNT/4691a571/QQ-v2.0.1-429_x64.deb" target="_blank" rel="noopener"
>https://dldir1.qq.com/qqfile/qq/QQNT/4691a571/QQ-v2.0.1-429_x64.deb&lt;/a>&lt;/p>
&lt;p>&lt;a class="link" href="https://dldir1.qq.com/qqfile/qq/QQNT/4691a571/QQ-v2.0.1-429_x64.rpm" target="_blank" rel="noopener"
>https://dldir1.qq.com/qqfile/qq/QQNT/4691a571/QQ-v2.0.1-429_x64.rpm&lt;/a>&lt;/p>
&lt;p>&lt;a class="link" href="https://dldir1.qq.com/qqfile/qq/QQNT/4691a571/QQ-v2.0.1-429_x64.AppImage" target="_blank" rel="noopener"
>https://dldir1.qq.com/qqfile/qq/QQNT/4691a571/QQ-v2.0.1-429_x64.AppImage&lt;/a>&lt;/p>
&lt;p>ps：暂时只支持x64架构，arm64架构还在加急适配中，敬请期待！关于体验名单&lt;code>仅限12月6日19点前&lt;/code>进群的成员&lt;/p>
&lt;p>关于体验反馈点击主面板左下角的“更多-帮助-意见反馈”进行用户反馈最后，期待并感谢大家的体验和反馈～&lt;/p>
&lt;h2 id="初步测试">初步测试
&lt;/h2>&lt;p>白名单内测，不在内测群的帐号登录不上。cpu不算太高，我这单核心30%以内，其他几个进程多数休眠状态。内测200-300M之间波动，&lt;/p>
&lt;p>比起第三方&lt;code>Icalingua++ &lt;/code>和旧版不错的地方&lt;/p>
&lt;ul>
&lt;li>可以群搜索&lt;/li>
&lt;li>可以折叠群&lt;/li>
&lt;li>群文件 正常&lt;/li>
&lt;li>私聊发送文件 正常&lt;/li>
&lt;li>界面和macos的测试版差不多。&lt;/li>
&lt;li>表情可以漫游&lt;/li>
&lt;li>邮箱可以调用默认浏览器&lt;/li>
&lt;li>有qq空间和小世界入口 调用内置浏览器&lt;/li>
&lt;li>等等&lt;/li>
&lt;/ul>
&lt;p>存在的问题&lt;/p>
&lt;ul>
&lt;li>arch i3w 下 没有系统托盘图标 没有消息通知 暂时不知道依赖和插件情况 无法处理，管理没明确说，这算是严重bug，后续应该会修复。&lt;/li>
&lt;li>没有语音通话和视频通话&lt;/li>
&lt;li>无法接受语音消息&lt;/li>
&lt;li>群聊里面 聊天记录列表不显示管理或者群主头衔，群聊右侧用户列表可以显示&lt;/li>
&lt;li>wayland 下截图应该是有问题&lt;/li>
&lt;li>x11 xorg 下截图会闪一下窗口，卡2秒左右&lt;/li>
&lt;li>群不显示在线人数，只显示全部人数&lt;/li>
&lt;li>有人反映不关闭新版QQ 无法关机&lt;/li>
&lt;li>需要扫码登录 暂时不支持密码登录，以后是否支持不确定（mac electron版已经支持）&lt;/li>
&lt;li>字体默认，无法修改，部分界面存在两种字体混用的情况 怪怪的。需要认真自行配置桌面环境字体。&lt;/li>
&lt;li>双击回复功能 没有，只能右键&lt;/li>
&lt;li>QQ频道 公众号 小程序也没有（这算最大优点 哈哈）&lt;/li>
&lt;li>小世界 没有硬解，纯软解，吃你2个核心的cpu不在话下 哈哈&lt;/li>
&lt;li>聊天记录 存放在 .config/QQ/nt_qq_XXXX/ 目录，自动备份config目录的同学注意啦。。&lt;/li>
&lt;li>小问题有一些，主要是系统托盘和消息提醒功能 以及语音和视频，但是整体可以用。&lt;/li>
&lt;/ul>
&lt;p>意外的惊喜&lt;/p>
&lt;ul>
&lt;li>全局快捷键支持，兼容i3w&lt;/li>
&lt;li>这个版本支持多开&lt;/li>
&lt;/ul>
&lt;h2 id="整体感觉">整体感觉
&lt;/h2>&lt;p>比之前的版本的界面好了不是一点半点，消息通知问题，晚点看看 应该可以解决。测试版也不是最终版。&lt;/p>
&lt;p>当然 也支持docker 运行&lt;/p>
&lt;p>用户文件看起来放 &lt;code>~/.config/QQ&lt;/code>里了,&lt;/p>
&lt;p>然后鬼畜的是聊天记录文件也放到config了 &lt;code>.config/QQ/nt_qq_XXXX/&lt;/code>。不知道这是内测版的失误，还是有心这样做的。群里讨论这个话题很长时间，官方管理没有对此回复。&lt;/p>
&lt;p>大部分linux用户有备份甚至自动同步config目录的习惯。这下 都被测试版给坑了。一会功夫config目录从几百K变成几个G&amp;hellip;.&lt;/p>
&lt;p>docker x11转发完美运行，再也不用担心qq 乱读我的文件 吃我cpu和内存了。&lt;/p>
&lt;p>感谢&lt;code>Icalingua++ &lt;/code> 的相伴，卸载啦&lt;/p>
&lt;h2 id="一点小遗憾">一点小遗憾
&lt;/h2>&lt;p>其实还是希望qt的，如果常用软件都electron了&amp;hellip;linux桌面环境只能更加恶劣&lt;/p>
&lt;h2 id="内测申请">内测申请
&lt;/h2>&lt;p>目前测试是内测白名单，群内昨天下午进群的自动白名单。没有进群的需要填写表单申请&lt;/p>
&lt;p>申请地址：
&lt;a class="link" href="https://docs.qq.com/form/page/DUXdac0ZaVEZUSnVn#/fill" target="_blank" rel="noopener"
>https://docs.qq.com/form/page/DUXdac0ZaVEZUSnVn#/fill&lt;/a>&lt;/p></description></item><item><title>archLinux 快速搭建golang开发环境</title><link>https://dev.leiyanhui.com/arch/arch-golang-codeserver/</link><pubDate>Tue, 06 Dec 2022 09:25:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/arch-golang-codeserver/</guid><description>&lt;h2 id="安装配置codeserver">安装配置codeserver
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">yay -S code-server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl enable --now code-server@$USER
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>默认地址：http://127.0.0.1:8080
配置文件在
&lt;code>~/.config/code-server/config.yaml&lt;/code>
简单修改允许外网访问，并在路由做好端口转发 或者nginx ssl代理&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">bind-addr: 0.0.0.0:8080
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">auth: password
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">password: 密码
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cert: false
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>重启&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo systemctl restart code-server@$USER
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="安装go">安装go
&lt;/h2>&lt;p>建议手动安装 ：&lt;a class="link" href="https://dev.leiyanhui.com/c/ubuntu-install-golang/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/c/ubuntu-install-golang/&lt;/a>&lt;br>
pacman 安装也可以&lt;code>sudo pacman -S go&lt;/code>&lt;/p>
&lt;h3 id="非root用户的处理">非root用户的处理
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd ~
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkdir .gocache
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>编辑&lt;code> /etc/profile&lt;/code> 或者用户目录下&lt;code>.profile&lt;/code>文件&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">GOCACHE&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="err">用户名&lt;/span>&lt;span class="o">/.&lt;/span>&lt;span class="n">gocache&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>完整内容&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">GO111MODULE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">on&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">GOROOT&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">go&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">GOPATH&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">gopath&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#export GOCACHE=/opt/gocache&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">GOCACHE&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="err">用户名&lt;/span>&lt;span class="o">/.&lt;/span>&lt;span class="n">gocache&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">GOPROXY&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">proxy&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">golang&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cn&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">direct&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">PATH&lt;/span>&lt;span class="o">=$&lt;/span>&lt;span class="n">PATH&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">GOROOT&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">GOPATH&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="配置codeserver的go插件">配置codeserver的go插件
&lt;/h2>&lt;blockquote>
&lt;p>注意点，如当前用户权限不够，需要su到root下执行,sudo执行 会有网络超时的问题
&lt;a class="link" href="https://dev.leiyanhui.com/codeserver/vscode-golang-err-gocache/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/codeserver/vscode-golang-err-gocache/&lt;/a>&lt;/p>&lt;/blockquote>
&lt;h2 id="测试一个项目">测试一个项目
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">mkdir golang &amp;amp;&amp;amp; cd golang
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git clone https://github.com/joyanhui/webdavgo.git
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">su #切换到root
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">go get golang.org/x/net/webdav #webdav
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>coderserver 打开运行测试&lt;/p></description></item><item><title>archLinux 快速搭建garduino单片机开发环境</title><link>https://dev.leiyanhui.com/arch/install-adruino/</link><pubDate>Tue, 06 Dec 2022 09:10:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/install-adruino/</guid><description>&lt;p>超简单&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S arduino
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>库文件路径 &lt;code>/home/用户名/.arduino15/&lt;/code>&lt;/p>
&lt;p>其他说明 &lt;a class="link" href="https://wiki.archlinux.org/title/Arduino_%28%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87%29#" target="_blank" rel="noopener"
>https://wiki.archlinux.org/title/Arduino_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#&lt;/a>&lt;/p></description></item><item><title>archlinux i3w下配置rustdesk</title><link>https://dev.leiyanhui.com/arch/rustdesk/</link><pubDate>Sun, 04 Dec 2022 00:23:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/rustdesk/</guid><description>&lt;p>##linux常用的远程桌面 方式
不得不说 对比 微软的rdp协议，linux和macos下 都没有可以比肩的。rdp可以在低带宽提供几乎没有任何延迟的桌面体验。但开源的xrdp相比而言 简直就是一个垃圾了。
如果是kvm运行的系统 也可以用spice协议。vnc这种上古方式，也不是不可以用，看个人需求吧。&lt;/p>
&lt;p>第三方的，好用一点点的基本都收费，我这里用rustdesk 来替代那些收费的第三方&lt;/p>
&lt;p>&lt;a class="link" href="https://wiki.archlinux.org/title/List_of_applications/Internet" target="_blank" rel="noopener"
>https://wiki.archlinux.org/title/List_of_applications/Internet&lt;/a>&lt;/p>
&lt;h2 id="前置">前置
&lt;/h2>&lt;ul>
&lt;li>pve中运行的archlinux安装了i3w 并基本可以用 &lt;a class="link" href="https://dev.leiyanhui.com/arch/startx/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/arch/startx/&lt;/a>&lt;/li>
&lt;li>安装了yay &lt;a class="link" href="https://dev.leiyanhui.com/c/archlinux-install-yay/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/c/archlinux-install-yay/&lt;/a>&lt;/li>
&lt;li>自建了一个rustdesk的中转服务器，&lt;a class="link" href="https://dev.leiyanhui.com/docker/rustdesk-server/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/docker/rustdesk-server/&lt;/a>
pve中分配给arch的显卡是 virio 支持3D&lt;/li>
&lt;/ul>
&lt;h2 id="安装">安装
&lt;/h2>&lt;p>rust官方提供了 zst 包&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">wget&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">c&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">gitee&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rustdesk&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rustdesk&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">releases&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">download&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">1.1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">9&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rustdesk&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">1.1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">9&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manjaro&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">arch&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">pkg&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">zst&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>gitee真牛比，国内网络可以提供比github还慢的速度&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pacman -U rustdesk-1.1.9-manjaro-arch.pkg.tar.zst
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>依赖也不少&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Packages&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">python&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">3.10&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span> &lt;span class="n">python&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">attrs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">22.1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">python&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cffi&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">1.15&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">python&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cryptography&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">38.0&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">python&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">packaging&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">21.3&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">python&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">pip&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">22.3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">python&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">ply&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">3.11&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="n">python&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">pycparser&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">2.21&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">python&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">pyparsing&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">3.0&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">9&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">python&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">wheel&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">0.38&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">ttf&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">arphic&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">uming&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">0.2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">20080216.2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">rustdesk&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">1.1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">9&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Total&lt;/span> &lt;span class="n">Download&lt;/span> &lt;span class="n">Size&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">23.72&lt;/span> &lt;span class="n">MiB&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Total&lt;/span> &lt;span class="n">Installed&lt;/span> &lt;span class="n">Size&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mf">119.66&lt;/span> &lt;span class="n">MiB&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="i3w-里面启动和配置">i3w 里面启动和配置
&lt;/h2>&lt;h3 id="启动">启动
&lt;/h3>&lt;p>win（hotkey）+d ，输入 restdesk，启动，配置id服务器和密钥&lt;/p>
&lt;h3 id="浮动窗口">浮动窗口
&lt;/h3>&lt;p>不开启浮动窗口的话。。。大概要占个屏幕&lt;/p>
&lt;h2 id="开机启动启动">开机启动启动
&lt;/h2>&lt;pre>&lt;code>sudo systemctl enable rustdesk
&lt;/code>&lt;/pre>
&lt;h2 id="rustdesk-不支持ttystartx-的解决">rustdesk 不支持tty（startx） 的解决。
&lt;/h2>&lt;p>需要安装一个显示管理器，我这里用lightdm&lt;/p>
&lt;pre>&lt;code> sudo pacman -S lightdm-gtk-greeter
sudo systemctl enable lightdm
sudo systemctl start lightdm
&lt;/code>&lt;/pre>
&lt;h2 id="lightdmi3的一些配置">lightdm+i3的一些配置
&lt;/h2>&lt;p>同时需要处理一下输入法和分辨率
直接改 i3的位置文件&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#壁纸
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">exec_always --no-startup-id feh --randomize --bg-fill ~/wallpaper
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#半透明
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">exec_always --no-startup-id picom
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#分辨率
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">exec --no-startup-id xrandr --output Virtual-1 --mode 1920x1080
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#输入法
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">exec --no-startup-id fcitx -d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#截屏工具
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">exec --no-startup-id flameshot
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>输入法 放到&lt;/p>
&lt;pre>&lt;code>nano .bashrc
&lt;/code>&lt;/pre>
&lt;h2 id="其他">其他
&lt;/h2>&lt;p>yay -S rustdesk 这个包有坑，不建议&lt;/p></description></item><item><title>archlinux 下rime输入法部分后选词乱码 问题</title><link>https://dev.leiyanhui.com/arch/rime-luanma/</link><pubDate>Sat, 26 Nov 2022 06:14:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/rime-luanma/</guid><description>&lt;p>最近win下先换到了rime输入法，因为反映速度快，对机器要求低。同时mac和ios 还有arch下也换到rime 。但是在arch下遇到一点小问题，就是部分后选词乱码。&lt;/p>
&lt;p>网上大概搜了一下，没有fcitx的详细方案。经过摸索&lt;/p>
&lt;p>比如：https://www.zdic.net/hans/%F0%A8%88%96 显示为 𨈖 还有 𫟄 同样的一些字在后选词里面显示豆腐块，但是打出来是正常&lt;/p>
&lt;p>是rime默认字体的原因，可以修改配置文件换字体，最简单方便 是就安装 noto字体包，然后重启一下就完了。基于&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">yay -S noto-fonts-sc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;gt; Found 08_NotoSansCJKsc.zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-&amp;gt; Found 13_NotoSansMonoCJKsc.zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-&amp;gt; Found 09_NotoSerifCJKsc.zip
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>或者干脆&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S noto-fonts-cjk
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>archlinux保姆级自定义安装-最简单，最小化 自定义分区安装 、efi和bios模式</title><link>https://dev.leiyanhui.com/arch/base-install/</link><pubDate>Sat, 26 Nov 2022 06:14:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/base-install/</guid><description>&lt;p>archlinux其实还是很容易安装的，&lt;/p>
&lt;blockquote>
&lt;p>本文最后更新 2022-12-01
安装系统需要你先明白几个基本概念,如果你能明白，那么手动安装一个archlinux也就轻松简单。不明白照着做也可。&lt;/p>&lt;/blockquote>
&lt;ul>
&lt;li>引导，一般电脑支持efi和传统bios两种分区模式，
&lt;ul>
&lt;li>bios引导分区模式需要用传统磁盘格式也就是只能4个主分区，或者3个主分区+扩展的N个分区&lt;/li>
&lt;li>efi引导的分区模式可以用gpt，也就是可以4个以上主分区，但是必须有一个fat16 fat32的分区，主板启动后从磁盘的这个分区里面找efi引导程序&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>磁盘 linux下的磁到 /dev下 一般用 &lt;code>fdisk -l&lt;/code>命令查看&lt;/li>
&lt;li>分区，linux下分区 需要挂载到文件目录。开机自动挂载的配置文件是 /etc/fatab&lt;/li>
&lt;/ul>
&lt;h2 id="启动后">启动后
&lt;/h2>&lt;p>如果是笔记本需要先配置wifi，arch的安装镜像也支持usb共享多数手机的网络。&lt;br>
如果不想在机器上上敲下面的命令，可以先给root设置一个临时密码&lt;code>passwd&lt;/code> 输入两次密码&lt;br>
然后&lt;code>ip a&lt;/code>查看一下ip，再在一台机器上ssh链接上&lt;code>ssh root@IP&lt;/code> ,就可以抄袭下面的作业了。&lt;br>
archlinux自带的 archinstall 已经很好用，一般情况不再建议手动安装。&lt;/p>
&lt;h2 id="分区">分区
&lt;/h2>&lt;p>efi模式至少两个分区，bois模式1个只一个分区也可以
1、efi分区 fat32格式，可以和黑苹果 win公用 （bois安装的分区 看文末）
2、根分区，格式自己随意，如果只是跑简单业务建议用ext4
其他分区自定义
分区可以用winpe diskgen，也可以用 live盘的 cfdisk&lt;/p>
&lt;h2 id="启动和准备">启动和准备
&lt;/h2>&lt;p>使用archlinux 官网live iso
下载地址 &lt;a class="link" href="https://archlinux.org/download/" target="_blank" rel="noopener"
>https://archlinux.org/download/&lt;/a> 底部有国内镜像源
写入到U盘，或者用ventoy等支持iso启动的工具启动iso。
启动后先 ping baidu.com 看看是否联网了，如果没有先去配置联网环境，此处掠过，不是笔记本的都简单，如果网卡不能识别，可以暂时usb插iPhone 打开共享&lt;/p>
&lt;h3 id="编辑源自己找一个靠谱源部分源更新慢比如-nuesoft部分源速度不稳定比如aliyun其他自己选">编辑源，自己找一个靠谱源。部分源更新慢，比如 nuesoft，部分源速度不稳定比如aliyun，其他自己选
&lt;/h3>&lt;blockquote>
&lt;p>此步骤不是必须的，目前新版archlinux 2022.11.1以后版本的iso 在联网环境下，可以自动帮你整理最快的镜像作为默认源&lt;/p>&lt;/blockquote>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">nano /etc/pacman.d/mirrorlist
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>例如清华源地址，放到 最前面
&lt;code>Server = https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch&lt;/code>&lt;/p>
&lt;h3 id="可能需要fdisk--l-查看一下磁盘并格式化部分分区">可能需要fdisk -l 查看一下磁盘并格式化部分分区
&lt;/h3>&lt;p>可以用&lt;code>cfdisk&lt;/code> 创建操作分区，使用uefi启动的电脑，至少需要两个分区，一个efi一个根分区，然后用mkfs.xxxx 格式化对应的分区&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cfdisk /dev/&amp;lt;磁盘名 sda1 nvmexxxx mmcxxx vdaxxx&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>cfdisk 比diskpart简单一些，并且是命令行的图形界面&lt;/p>
&lt;h4 id="关于分区">关于分区
&lt;/h4>&lt;p>如果是efi模式启动，必须需要两个分区 一个 32M 以上的efi分区格式化为fat16或者fat32格式，另外一个分区格式为linux常用文件系统格式，推荐ext4格式&lt;br>
如果是传统启动模式，那么不需要额外的分区，最小只需要一个分区 / 格式为&lt;/p>
&lt;h4 id="关于分区格式">关于分区格式
&lt;/h4>&lt;p>linux下不是不是可以安装到fat或者exfat 甚至ntfs分区格式，只是不推荐，会有很多莫名其妙的问题。&lt;br>
一般常用的分区格式 还是 ext4，其他更先进的分区格式 xfs,BtrFS,GlusterFS 除非非常有需求，比如压缩 快照 raid等，否则不建议。&lt;br>
如果你双系统，有和win交换文件的需求，强烈建议单独创一个exfat分区作为文件交换用，或者在win下安装ext4的读取驱动（不要写）&lt;/p>
&lt;blockquote>
&lt;p>另外，win下常用的diskgen 对ext4分区的支持是有限的，但是可以完成基本的分区到镜像的备份。读取功能不稳。&lt;/p>&lt;/blockquote>
&lt;h4 id="格式需要的分区">格式需要的分区
&lt;/h4>&lt;p>cfdisk只能分区不能格式，还是需要用mkfs工具格式，如果已经格式好了。或者对应的分区已经有文件，可以跳过这步。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"># efi分区
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkfs.fat -F 32 /dev/nvme0n1p1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">## 根分区
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkfs.ext4 /dev/nvme0n1p2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;blockquote>
&lt;p>马上2023年 brtfs已经很不错了um
efi必须 fa32 或fat16， 根分区 分区格式我这里用ext4&lt;br>
如果要做swap分区，自己看一下官网wiki，我喜欢用文件swap所以这里没弄。 &lt;a class="link" href="https://dev.leiyanhui.com/arch/swapfile/" target="_blank" rel="noopener"
>设置 文件swap&lt;/a>&lt;/p>&lt;/blockquote>
&lt;h3 id="挂载分区">挂载分区
&lt;/h3>&lt;p>根分区挂载到/mnt efi分区挂载到/mnt/boot/efi&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">mount /dev/nvme0n1p2 /mnt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkdir -p /mnt/boot/efi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mount /dev/nvme0n1p1 /mnt/boot/efi
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>如果你还要做swap分区，继续弄，也可以后面开启swapfile的&lt;br>
如果是传统启动模式 不是 efi模式 可以跳过 挂载efi的这步。&lt;/p>
&lt;h2 id="mnt开始安装">/mnt开始安装
&lt;/h2>&lt;p>最基本的系统&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pacstrap /mnt base linux
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>另外还有三个常用包 自己选择是否安装。&lt;code>linux-headers linux-firmware base-devel&lt;/code> base-devel包里面 有编译和yay（aur）常用的工具&lt;/p>
&lt;blockquote>
&lt;p>如果有提示 key错误，尤其是openssl的，可能需要先执行一次&lt;/p>&lt;/blockquote>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pacman -S archlinux-keyring
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pacman-key --refresh-keys
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>或者 干脆运行一次&lt;code>archinstall&lt;/code> 然后会自动更新keyting，再退出就好了&lt;/p>
&lt;h2 id="写入自动挂载fstab">写入自动挂载fstab
&lt;/h2>&lt;p>直接用genfstab 工具，免去手写fstab配置文件的麻烦&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">genfstab -U /mnt &amp;gt;&amp;gt; /mnt/etc/fstab
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat /mnt/etc/fstab
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="切换到新系统">切换到新系统
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">arch-chroot /mnt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="继续安装一些基础包-简单文本编辑nano--sudo权限管理-或者-dosa">继续安装一些基础包 简单文本编辑nano sudo权限管理 或者 dosa
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pacman -S nano
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>你也可以装vim&lt;/p>
&lt;h3 id="可选包网络相关的">可选包网络相关的
&lt;/h3>&lt;p>dhcp客户端，ssh服务器端，网络管理，usb共享iPhone网络&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pacman -S dhcpcd openssh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="设置几个需要开机启动的服务">设置几个需要开机启动的服务
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">systemctl enable dhcpcd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl enable sshd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>可选包&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pacman -S networkmanager usbmuxd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl enable systemd-resolved
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl enable NetworkManager
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="修改root密码-设置用户等">修改root密码 设置用户等
&lt;/h2>&lt;h3 id="root密码">root密码
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">passwd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="添加用户">添加用户
&lt;/h3>&lt;p>添加一个日常使用用户，同时这个用户默认可以ssh登录&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">useradd -m -G wheel -s /bin/bash leiyanhui
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">passwd leiyanhui
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>我用fish替代bash 但是不建议 用fish 彻底替代bash，因为fish和bash ash之间有兼容问题。
基础shell 还是 base 或者 ash。 想要fish自动自动，以后修改 &lt;code>.bashrc&lt;/code>文件就好了&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pacman -S fish
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="设置wheel用户组的sudo权限">设置wheel用户组的sudo权限
&lt;/h3>&lt;h4 id="sudo">sudo
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pacman -S sudo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nano /etc/sudoers
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>找到&lt;code># %wheel ALL=(ALL:ALL) ALL&lt;/code> 取消前面的#注释 或者带 NOPASSWD的 那行，以后sudo 就不需要密码&lt;/p>
&lt;h4 id="doas">doas
&lt;/h4>&lt;blockquote>
&lt;p>替代sudo 更轻量更简单，如果要用xrdp的话不建议用doas&lt;/p>&lt;/blockquote>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pacman -S doas
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nano /etc/doas.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">permit :wheel
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>或者&lt;code>permit persist :wheel&lt;/code> 后面需要有一个空行
设置文件权限&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">chown -c root:root /etc/doas.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod -c 0400 /etc/doas.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>验证&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">doas -C /etc/doas.conf &amp;amp;&amp;amp; echo &amp;#34;config ok&amp;#34; || echo &amp;#34;config error&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>替代sudo&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">ln -s /bin/dosa /bin/sudo
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="设置时区-对时">设置时区 对时
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">hwclock --systohc
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="写入引导">写入引导
&lt;/h2>&lt;p>还是建议用grub，因为如果你要后面折腾虚拟化 kvm之类的会省心甚多 （bois安装的分区 看文末）&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pacman -S grub efibootmgr
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">grub-install /dev/nvme0n1 #(注意，不是efi分区，而且是整个磁盘)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">grub-mkconfig -o /boot/grub/grub.cfg
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>grub-mkconfig 这个工具在efibootmgr包里面&lt;/p>
&lt;h2 id="重启">重启
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">exit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># 退出到live盘
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">reboot # 或者 poweroff
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="系统备份">系统备份
&lt;/h2>&lt;p>可以用live盘 直接 tar 整个 /mnt，如果用ext4分区 也可以Windows用diskgen备份。
修复引导 就live 盘 arch-chroot 到磁盘分区，然后 重新写入一次引导 和配置文件&lt;/p>
&lt;h2 id="传统启动模式安装">传统启动模式安装
&lt;/h2>&lt;blockquote>
&lt;p>适合于 老设备，或者 虚拟机，尤其是 pve下的kvm模式
只需要最少一个分区就可以了 ，其他操作和efi一样&lt;/p>&lt;/blockquote>
&lt;p>注意点 就是 cfdisk 第一次打开的时候 不能用gpt分区，用dos分区模式，如果弄错了就要重新设置格式，会丢失所有数据。&lt;/p>
&lt;pre>&lt;code>parted /dev/vda
#然后输入
mklabel msdos
#提示你会丢失所有书
Yes
#退出
quit
&lt;/code>&lt;/pre>
&lt;p>我这个系统是用来打算做kvm的底层的，所以除了docker不再安装任何东西&lt;/p>
&lt;p>所有安装的包记录&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">base linux linux-headers linux-firmware
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#基本工具
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo nano
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#网络
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dhcpcd networkmanager openssh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#引导
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">grub efibootmgr
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#个人需要的 exfat 和 fish
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">exfat-utils
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fish
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># kvm相关的
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">qemu-base
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ovmf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>我上面没有设置swap 是因为我习惯性用swap file
查看这里： &lt;a class="link" href="https://dev.leiyanhui.com/arch/swapfile/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/arch/swapfile/&lt;/a>&lt;/p>
&lt;h2 id="进阶功能和相关记录文章">进阶功能和相关记录文章
&lt;/h2>&lt;h3 id="手动安装一个archlinux">手动安装一个archlinux
&lt;/h3>&lt;p>查看这里： &lt;a class="link" href="https://dev.leiyanhui.com/arch/base-install/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/arch/base-install/&lt;/a>&lt;/p>
&lt;h3 id="桌面环境dwm">桌面环境dwm
&lt;/h3>&lt;p>查看这里：&lt;a class="link" href="https://dev.leiyanhui.com/linux/arch-install-dwm/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/linux/arch-install-dwm/&lt;/a>&lt;/p>
&lt;h3 id="桌面环境i3w">桌面环境i3w
&lt;/h3>&lt;p>查看这里：&lt;a class="link" href="https://dev.leiyanhui.com/arch/xinitc-xrdp/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/arch/xinitc-xrdp/&lt;/a>&lt;/p>
&lt;h4 id="arch下kvm基本安装">arch下kvm基本安装
&lt;/h4>&lt;p>查看这里： &lt;a class="link" href="https://dev.leiyanhui.com/kvm/arch-install-kvm/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/kvm/arch-install-kvm/&lt;/a>&lt;/p>
&lt;h4 id="arch下kvm虚拟机开机自动启动">arch下kvm虚拟机开机自动启动
&lt;/h4>&lt;p>查看这里： &lt;a class="link" href="https://dev.leiyanhui.com/kvm/auto_start_vm/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/kvm/auto_start_vm/&lt;/a>&lt;/p>
&lt;h4 id="关于efi模式启动">关于efi模式启动
&lt;/h4>&lt;p>查看这里： &lt;a class="link" href="https://dev.leiyanhui.com/kvm/ovmf/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/kvm/ovmf/&lt;/a>&lt;/p>
&lt;h4 id="kvm安装macos">kvm安装macos
&lt;/h4>&lt;p>查看这里：&lt;a class="link" href="https://dev.leiyanhui.com/kvm/install-macos-base/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/kvm/install-macos-base/&lt;/a>&lt;/p>
&lt;h4 id="kvm安装macos附加上一个win">kvm安装macos附加上一个win
&lt;/h4>&lt;p>查看这里：&lt;a class="link" href="https://dev.leiyanhui.com/kvm/macos_add_win10/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/kvm/macos_add_win10/&lt;/a>&lt;/p>
&lt;h3 id="进阶配置桥接网络以及硬件直通">进阶：配置桥接网络，以及硬件直通
&lt;/h3>&lt;p>桥接网络：&lt;a class="link" href="https://dev.leiyanhui.com/kvm/net-br/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/kvm/net-br/&lt;/a>&lt;br>
硬件直通：&lt;a class="link" href="https://dev.leiyanhui.com/kvm/kvm/pci-usb/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/kvm/kvm/pci-usb/&lt;/a>&lt;/p></description></item><item><title>把最新版本 archlinux安装到vhd/raw/img文件并物理机器启动</title><link>https://dev.leiyanhui.com/arch/boot-vhd-ventoy/</link><pubDate>Sat, 26 Nov 2022 06:14:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/boot-vhd-ventoy/</guid><description>&lt;h2 id="前言">前言
&lt;/h2>&lt;p>本文基于 archlinux 2022-12-1 镜像 ventoy-1.0.86 vtoyboot-1.0.25&lt;/p>
&lt;p>我做好的 &lt;a class="link" href="https://www.123pan.com/s/EqorVv-r2nPA" target="_blank" rel="noopener"
>https://www.123pan.com/s/EqorVv-r2nPA&lt;/a> 提取码:arch&lt;/p>
&lt;p>建议选择 arch-base-btrfs-7.3gfree5g.vhd.vtoy.7z 解压后7.3G 空闲5G 可以满足基本需求，可以自行扩容。&lt;a class="link" href="https://dev.leiyanhui.com/arch/ventoy-vdisk-resize/" target="_blank" rel="noopener"
>扩容教程&lt;/a>
这个也是&lt;a class="link" href="https://dev.leiyanhui.com/all-in-one/diy/" target="_blank" rel="noopener"
>我的arch-aio的母盘&lt;/a>
默认用户名 yanhui 密码 1 开启了ssh 和 dhcp&lt;br>
root用户禁止ssh 密码 1
直接用archinstall安装的基础包，然后补充软件：&lt;br>
&lt;code> dhcpcd openssh nano doas which lvm2&lt;/code>&lt;/p>
&lt;blockquote>
&lt;p>如果你网卡不能免驱 或者wifi要处理，请先virtualbox 启动后配置网卡驱动&lt;br>
如果内核升级 或者grub升级，记得 &lt;code>cd /root/vtoyboot* &amp;amp;&amp;amp;sh vtoyboot.sh &lt;/code>&lt;/p>&lt;/blockquote>
&lt;h2 id="安装archlinux">安装archlinux
&lt;/h2>&lt;p>需要有一个运行了虚拟机的系统，我这里用的 linux版 virtualbox ，win下一样操作&lt;/p>
&lt;p>virtualbox 创建一个虚拟机，专家模式 启用efi，磁盘格式选择 vhd，也可以其他格式 稍后自行转换到 vhd vdi raw 必须是预分配磁盘，不可以使用动态磁盘&lt;/p>
&lt;p>我这里选择 vhd格式，&lt;/p>
&lt;h2 id="其他安装步骤-和正常安装一样">其他安装步骤 和正常安装一样
&lt;/h2>&lt;p>&lt;a class="link" href="https://dev.leiyanhui.com/arch/base-install/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/arch/base-install/&lt;/a>&lt;/p>
&lt;p>并且&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">ln -s /bin/doas /bin/sudo
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="处理ventoy">处理Ventoy
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pacman -S which lvm2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>虚拟机挂载 &lt;a class="link" href="https://github.com/ventoy/vtoyboot/releases/download/v1.0.25/vtoyboot-1.0.25.iso" target="_blank" rel="noopener"
>https://github.com/ventoy/vtoyboot/releases/download/v1.0.25/vtoyboot-1.0.25.iso&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">mount /dev/cdrom /mnt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cd /root
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp /mnt/vtoy* .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tar -xf vtoy*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm -rf *.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cd vtoyboot*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sh vtoyboot.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>提示只能用于efi启动&lt;/p>
&lt;h2 id="ventoy硬盘或者u盘安装配置">ventoy硬盘或者U盘安装配置
&lt;/h2>&lt;p>很简单不用多说了。注意一点 &lt;code>VTOY_LINUX_REMOUNT&lt;/code> 方便linux下挂载管理vhd所在分区
具体参考 ：https://www.ventoy.net/cn/faq.html 搜索 VTOY_LINUX_REMOUNT 关键词&lt;/p>
&lt;h2 id="其他处理">其他处理
&lt;/h2>&lt;h3 id="autodetect-处理-据说兼容性更好">autodetect 处理 据说兼容性更好
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">nano /etc/mkinitcpio.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>把hooks一行的autodetect删掉&lt;/p>
&lt;h3 id="grub-shell抢救">grub shell抢救
&lt;/h3>&lt;p>如果非常不幸地进入了grub shell，也就是只有个grub&amp;gt;的界面，可以按照下面的步骤来抢救：&lt;/p>
&lt;pre>&lt;code>ls来查看硬盘，（hd0）这样的是硬盘，（hd0，msdos1）这样的是分区
ls (hd0,msdos1)/（注意有斜杠）来查看分区里的内容，找到那个里面有vmlinuz-linux文件的，它是启动分区
set root=(hd0,msdos1)（hd0，msdos1）改成你的启动分区
linux /vmlinuz-linux root=/dev/sda1sda1改成你的根目录分区
initrd /initramfs-linux.img
boot
&lt;/code>&lt;/pre>
&lt;p>就可以进系统了，再想想引导怎么配吧。&lt;/p>
&lt;p>本文参考 ：https://www.bilibili.com/read/cv19777065 感谢 &lt;code>monki&lt;/code>&lt;/p></description></item><item><title>archlinux 下 i3w 基于 wayland的实现</title><link>https://dev.leiyanhui.com/arch/i3-wayland/</link><pubDate>Sat, 19 Nov 2022 20:52:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/i3-wayland/</guid><description>&lt;blockquote>
&lt;p>最近一直被安利 wayland，在kvm下核显直通的arch中尝试一下，刚好要做一个核显直通的kvm-arch&lt;/p>&lt;/blockquote>
&lt;h2 id="安装基础包">安装基础包
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> sway alacritty waybar wofi \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> xorg-xwayland xorg-xlsclients qt5-wayland glfw-wayland
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>sway 是 wayland下的i3&lt;/p>
&lt;p>alacritty 是简单终端&lt;/p>
&lt;p>waybar 是一个简单好用的自定义状态栏&lt;/p>
&lt;p>Wofi 一个纯 GTK（也就是 Wayland）的可定制应用程序启动器。&lt;/p>
&lt;p>qt5-wayland 和 glfw-wayland 分别为 QT5 和 GLFW 提供 Wayland 兼容 API&lt;/p>
&lt;h2 id="输入法和字体">输入法和字体
&lt;/h2>&lt;pre>&lt;code>sudo pacman -S ttf-dejavu wqy-zenhei
sudo pacman -S fcitx-im fcitx-configtool fcitx-googlepinyin
&lt;/code>&lt;/pre>
&lt;h2 id="配置文件">配置文件
&lt;/h2>&lt;p>Sway 应该是完全兼容i3的配置文件的，不过这里还是 从头配置一个&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd ~/.config
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkdir sway
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cd sway
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp /etc/sway/config .
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这里不需要 .xinitrc 了&lt;/p>
&lt;h2 id="显卡驱动">显卡驱动
&lt;/h2>&lt;p>我这里直通的核显&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S linux-firmware xf86-video-intel
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="seatd的处理">seatd的处理
&lt;/h2>&lt;pre>&lt;code>sudo pacman -S seatd
sudo systemctl enable seatd
sudo systemctl start seatd
sudo usermod -aG seat 你的用户名
&lt;/code>&lt;/pre>
&lt;p>##启动命令&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sway
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="其他启动问题">其他启动问题
&lt;/h2>&lt;h3 id="提示-prime-import-not-supported">提示 PRIME import not supported
&lt;/h3>&lt;p>显卡不支持，多是虚拟机里面运行的时候导致的。 如果是kvm 换 virtio gpu 就ok 了&lt;/p>
&lt;h3 id="提示-failed-to-create-dri2-screendri-failed-to-create-screen">提示 failed to create dri2 screen/dri failed to create screen
&lt;/h3></description></item><item><title>archlinux开机自动启动自定义脚本</title><link>https://dev.leiyanhui.com/arch/autostar/</link><pubDate>Fri, 18 Nov 2022 20:10:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/autostar/</guid><description>&lt;p>随着 systemctl 的出现，古老的开机自启动脚本 rc.local 从 archlinux 上消失了。 以后再使用就需要用systemctl&lt;/p>
&lt;p>这里尝试自己弄一个&lt;code>my-local&lt;/code> 注册到systemctl&lt;/p>
&lt;h2 id="创建systemctl-service">创建systemctl service
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">#/usr/lib/systemd/system/my-local.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[Unit]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Description=&amp;#34;自定义启动脚本&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[Service]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Type=forking
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ExecStart=/etc/my-local.sh start #在这里你可以看到开机执行脚本的位置
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TimeoutSec=0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">StandardInput=tty
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">RemainAfterExit=yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SysVStartPriority=99
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[Install]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WantedBy=multi-user.target
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="编写启动脚本-etcmy-localsh">编写启动脚本 /etc/my-local.sh
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/sh
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>sh /home/xxx/mount.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">exit&lt;/span> &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="配置开机自动启动">配置开机自动启动
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo chmod u+x /etc/my-local.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl enable my-local.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="远程登陆自动执行的脚本">远程登陆自动执行的脚本
&lt;/h2>&lt;p>直接编辑 用户的 .bashrc 例如&lt;/p>
&lt;pre>&lt;code>#
# ~/.bashrc
#
# If not running interactively, don't do anything
[[ $- != *i* ]] &amp;amp;&amp;amp; return
alias ls='ls --color=auto'
PS1='[\u@\h \W]\$ '
neofetch
cat /home/yanhui/readme.md
fish
&lt;/code>&lt;/pre></description></item><item><title>archlinux 下安装xrdp和xinitrc i3w共存</title><link>https://dev.leiyanhui.com/arch/xinitc-xrdp/</link><pubDate>Fri, 18 Nov 2022 04:40:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/xinitc-xrdp/</guid><description>&lt;p>本文停更新，新版查看 ：&lt;a class="link" href="https://dev.leiyanhui.com/arch/xrdp-all/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/arch/xrdp-all/&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>本文基于kvm下的arch 核显直通 或者 lxc容器&lt;/p>&lt;/blockquote>
&lt;p>基本安装参考 &lt;a class="link" href="https://dev.leiyanhui.com/arch/base-install/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/arch/base-install/&lt;/a>&lt;/p>
&lt;p>如果是容器的arch，如果pacman 不能用，记得 先 &lt;code>pcaman-key --init &amp;amp;&amp;amp; pacman-key --populate archlinux &lt;/code> 另外 更新到最新版本 防止部分更新的问题&lt;code>sudo pacman -Syyu&lt;/code>&lt;/p>
&lt;h2 id="核显驱动">核显驱动
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S xf86-video-intel
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>其他显卡自己看一下驱动包，如果是kvm下的直接用 virtio-gpu 可以实现3D加速的，可能不需要这个&lt;/p>
&lt;h2 id="先安装i3w-简单配置">先安装i3w 简单配置
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S xorg-server #xorg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S xorg-xinit # 登录器
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S ttf-dejavu wqy-microhei # wqy-zenhei #字体
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S fish #我喜欢的shell
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S flameshot #我喜欢的截图工具
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S i3-gaps i3status # i3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S feh picom dmenu # 壁纸和半透明 启动器
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="输入法">输入法
&lt;/h2>&lt;pre>&lt;code>sudo pacman -S fcitx-im fcitx-configtool fcitx-googlepinyin #输入法 1) fcitx
&lt;/code>&lt;/pre>
&lt;p>在i3 要 在终端 sudo 执行一次 fcitx-configtool&lt;/p>
&lt;h2 id="复制xinit">复制xinit
&lt;/h2>&lt;p>我没用sdm，直接用startx 或 xrdp 所以这里配置xinit&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">cp&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">X11&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">xinit&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">xinitrc&lt;/span> &lt;span class="o">~/.&lt;/span>&lt;span class="n">xinitrc&lt;/span> &lt;span class="c1">#复制一个过来&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">nano&lt;/span> &lt;span class="o">~/.&lt;/span>&lt;span class="n">xinitrc&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#注释掉最后的几行-添加一行&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">GTK_IM_MODULE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">fcitx&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">QT_IM_MODULE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">fcitx&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">XMODIFIERS&lt;/span>&lt;span class="o">=&lt;/span>\&lt;span class="err">@&lt;/span>&lt;span class="n">im&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">fcitx&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">fcitx&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="c1">#输入法&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">flameshot&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="c1">#截图工具&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#nm-applet &amp;amp; #wifi系统托盘&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">exec&lt;/span> &lt;span class="n">i3&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="还要来点常用工具">还要来点常用工具
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S firefox unzip wget
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># 远程到win的工具
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S remmina
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S libvncserver
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S spice-gtk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S freerdp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="弄一下壁纸">弄一下壁纸
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">cd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget -c https://github.com/joyanhui/file.leiyanhui.com/archive/refs/heads/dwm-wallpaper.zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">unzip dwm-wallpaper.zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv file.leiyanhui.com-dwm-wallpaper bg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm -rf dwm-wallpaper.zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm -rf bg/README.md
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="i3w配置文件">i3w配置文件
&lt;/h2>&lt;p>i3w的配置过程 是个大工程，参考我的 &lt;a class="link" href="https://github.com/joyanhui/i3w" target="_blank" rel="noopener"
>https://github.com/joyanhui/i3w&lt;/a>&lt;/p>
&lt;h2 id="准备xrdp">准备xrdp
&lt;/h2>&lt;h3 id="安装yay">安装yay
&lt;/h3>&lt;p>&lt;a class="link" href="https://dev.leiyanhui.com/c/archlinux-install-yay/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/c/archlinux-install-yay/&lt;/a>
yay 的使用，需要可能需要 patch autoconf automake pkg-config akeroot、binutils等包 建议直接安装 &lt;code>base-devel &lt;/code>&lt;/p>
&lt;pre>&lt;code>pacman -S base-devel
&lt;/code>&lt;/pre>
&lt;h3 id="挂个v2代理">挂个v2代理
&lt;/h3>&lt;pre>&lt;code>nano proxy.sh #然后 sh proxy.sh一下
&lt;/code>&lt;/pre>
&lt;p>内容&lt;/p>
&lt;pre>&lt;code>export http_proxy=&amp;quot;10.0.0.1:20172&amp;quot;
export https_proxy=&amp;quot;10.0.0.1:20172&amp;quot;
&lt;/code>&lt;/pre>
&lt;h3 id="安装xrdp">安装xrdp
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">#yay -S xorgxrdp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pacman -S base-devel
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yay -S xrdp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yay -S xorgxrdp-glamor
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S pulseaudio
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yay -S pulseaudio-module-xrdp # 有可能需要 sudo pacman -S sbc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S xorg-xrdb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="xwrapper">Xwrapper
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo nano /etc/X11/Xwrapper.config
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">allowed_users=anybody
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo systemctl enable xrdp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl start xrdp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="其他可选-dmenu">其他可选 dmenu
&lt;/h3>&lt;p>换一下dmenu为支持变暗、修改透明度、下划线（可选）&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -Rns dmenu
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yay -S dmenu2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="其他可选-终端工具">其他可选 终端工具
&lt;/h3>&lt;pre>&lt;code>sudo pacman -S alacritty
&lt;/code>&lt;/pre>
&lt;p>alacritty的配置文件为：~/.config/alacritty/alacritty.yml&lt;/p>
&lt;h3 id="一些零碎的软件包">一些零碎的软件包
&lt;/h3>&lt;ul>
&lt;li>i3lock # 锁屏&lt;/li>
&lt;li>nm-applet # wifi信号 网络状态 系统托盘图标&lt;/li>
&lt;li>&lt;/li>
&lt;/ul></description></item><item><title>archlinux 图形界面i3安装 到 正常可以用的工作机，包括输入法 浏览器 微信 qq等</title><link>https://dev.leiyanhui.com/arch/startx/</link><pubDate>Tue, 15 Nov 2022 15:23:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/startx/</guid><description>&lt;h2 id="先安装arch">先安装arch
&lt;/h2>&lt;p>手动安装的 &lt;a class="link" href="https://dev.leiyanhui.com/arch/base-install/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/arch/base-install/&lt;/a>&lt;/p>
&lt;h2 id="然后安装图形界面">然后安装图形界面
&lt;/h2>&lt;p>我之前一直用dwm环境，但是dwm桌面有一个小问题就是 每次修改配置 都需要重新重新编译，并且重启一次x 略微麻烦，这次我开始更换使用i3w&lt;/p>
&lt;h3 id="显卡驱动">显卡驱动
&lt;/h3>&lt;p>先安装linux-firmware,搞定基本的驱动&lt;/p>
&lt;pre>&lt;code>pacman -S linux-firmware
&lt;/code>&lt;/pre>
&lt;p>当然是显卡驱动 &lt;code>lspci | grep VGA&lt;/code> &lt;code>$ sudo pacman -S 驱动包&lt;/code>&lt;/p>
&lt;pre>&lt;code>通用----------------------------------xf86-video-vesa
intel----------------------------------xf86-video-intel
Geforce7±-------------------------xf86-video-nouveau
Geforce6/7-------------------------xf86-video-304xx
&lt;/code>&lt;/pre>
&lt;h4 id="virtualbox-需要另外处理">virtualbox 需要另外处理
&lt;/h4>&lt;h5 id="修改显存到256m好像最大就是256m">修改显存到256M（好像最大就是256M）
&lt;/h5>&lt;pre>&lt;code>VBoxManage modifyvm &amp;quot;archlinux&amp;quot; --vram 256
&lt;/code>&lt;/pre>
&lt;h5 id="安装virtualbox驱动">安装virtualbox驱动
&lt;/h5>&lt;p>启动虚拟机，vbox中 菜单点设备，安装增强功能 或者手动挂载VBoxGuestAdditions.iso 到虚拟机，arch中挂载虚拟光驱&lt;/p>
&lt;pre>&lt;code>sudo mount /dev/cdrom /mnt
/mnt/VBoxLinuxADXXX.run #tab 自动补全
&lt;/code>&lt;/pre>
&lt;h3 id="kvm下的处理">kvm下的处理
&lt;/h3>&lt;p>kvm模式跑的arch 可以用 virio-gpu 的显卡，内核支持3D，不需要另外驱动。宿主要驱动。&lt;/p>
&lt;h3 id="安装xorg">安装xorg
&lt;/h3>&lt;pre>&lt;code>sudo pacman -S xorg-server
&lt;/code>&lt;/pre>
&lt;h3 id="安装点字体">安装点字体
&lt;/h3>&lt;pre>&lt;code>sudo pacman -S ttf-dejavu wqy-microhei
&lt;/code>&lt;/pre>
&lt;h3 id="安装sddm-或者用startx我选startx">安装sddm 或者用startx，我选startx
&lt;/h3>&lt;pre>&lt;code>sudo pacman -S xorg-xinit
&lt;/code>&lt;/pre>
&lt;h3 id="安装桌面环境我用i3wm并且选gaps分支">安装桌面环境，我用i3wm，并且选gaps分支
&lt;/h3>&lt;pre>&lt;code>sudo pacman -S i3-gaps
&lt;/code>&lt;/pre>
&lt;h3 id="安装终端">安装终端
&lt;/h3>&lt;pre>&lt;code>sudo pacman -S alacritty #也可以用 mate-terminal 或者st 默认是 i3-sensible-terminal
&lt;/code>&lt;/pre>
&lt;h3 id="菜单工具">菜单工具
&lt;/h3>&lt;pre>&lt;code>sudo pacman -S dmenu
&lt;/code>&lt;/pre>
&lt;h3 id="状态栏">状态栏
&lt;/h3>&lt;pre>&lt;code>sudo pacman -S i3status
&lt;/code>&lt;/pre>
&lt;h3 id="输入法">输入法
&lt;/h3>&lt;pre>&lt;code>sudo pacman -S fcitx-im fcitx-configtool fcitx-googlepinyin fcitx-cloudpinyin #不怕折腾 用 fcitx-rime 极度流畅，但是不支持 fcitx-cloudpinyin
&lt;/code>&lt;/pre>
&lt;h3 id="浏览器我用火狐edge要aur哈">浏览器，我用火狐，edge要aur哈
&lt;/h3>&lt;pre>&lt;code>sudo pacman -S firefox
&lt;/code>&lt;/pre>
&lt;h3 id="截图-系统托盘图标">截图 系统托盘图标
&lt;/h3>&lt;pre>&lt;code>sudo pacman -S flameshot nm-connection-editor network-manager-applet
&lt;/code>&lt;/pre>
&lt;h3 id="配置wifi">配置wifi
&lt;/h3>&lt;pre>&lt;code>sudo nmcli device wifi connect wifi名称 password wifi密码
&lt;/code>&lt;/pre>
&lt;h3 id="蓝牙相关">蓝牙相关
&lt;/h3>&lt;pre>&lt;code>sudo pacmsn -S usbutils bluez bluez-utils
sudo systemctl enable bluetooth
sudo systemctl start bluetooth
bluetoothctl
&lt;/code>&lt;/pre>
&lt;h3 id="qq和微信">qq和微信
&lt;/h3>&lt;pre>&lt;code>sudo pacman -S base-devel
sudo pacman -S dunst libnotify # 通知消息
yay -S electronic-wechat-uos-bin icalingua++
&lt;/code>&lt;/pre>
&lt;p>yay的安装参考：&lt;a class="link" href="https://dev.leiyanhui.com/c/archlinux-install-yay/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/c/archlinux-install-yay/&lt;/a>&lt;/p>
&lt;p>&lt;a class="link" href="https://dev.leiyanhui.com/linux/wecha-new-debian" target="_blank" rel="noopener"
>2024-03-7 已经有原生版微信，虽然目前之支持uos和麒麟等系统，实际上其他系统也可以用。&lt;/a>&lt;/p>
&lt;p>&lt;a class="link" href="https://dev.leiyanhui.com/arch/new-qq2022/" target="_blank" rel="noopener"
>2022年12月07日 腾讯已经发布新版linux qq &lt;/a>&lt;/p>
&lt;h3 id="文件管理器">文件管理器
&lt;/h3>&lt;pre>&lt;code>sudo pacman -S thunar
&lt;/code>&lt;/pre>
&lt;h3 id="文本编辑器">文本编辑器
&lt;/h3>&lt;pre>&lt;code>sudo pacman -S xde # gedit
&lt;/code>&lt;/pre>
&lt;h3 id="配置startx">配置startx
&lt;/h3>&lt;pre>&lt;code>cp /etc/X11/xinit/xinitrc ~/.xinitrc #复制一个过来
nano ~/.xinitrc
#注释掉最后的几行-添加几行
export GTK_IM_MODULE=fcitx
export QT_IM_MODULE=fcitx
export XMODIFIERS=\@im=fcitx
fcitx &amp;amp;
flameshot &amp;amp; #截图工具
nm-applet &amp;amp; #wifi系统托盘
exec i3
&lt;/code>&lt;/pre>
&lt;p>输入法的配置最好加到 ~/.pam_environment
ibus的话参考 [https://dev.leiyanhui.com/arch/base-install/]](&lt;a class="link" href="https://dev.leiyanhui.com/arch/base-install/]" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/arch/base-install/]&lt;/a>)&lt;/p>
&lt;h2 id="启动i3">启动i3
&lt;/h2>&lt;pre>&lt;code>startx
&lt;/code>&lt;/pre>
&lt;h2 id="壁纸">壁纸
&lt;/h2>&lt;pre>&lt;code>sudo pacman -S feh
mkdir ~/wallpaper &amp;amp;&amp;amp; cd ~/wallpaper
sudo pacman -S unzip wget # 解压和下载工具
## 从我自己的仓库下载一点壁纸
wget -c https://github.com/joyanhui/file.leiyanhui.com/archive/refs/heads/dwm-wallpaper.zip
unzip dwm-wallpaper.zip
mv file.leiyanhui.com-dwm-wallpaper/*.jpg .
rm -rf dwm-wallpaper.zip file.leiyanhui.com-dwm-wallpaper
&lt;/code>&lt;/pre>
&lt;h2 id="半透明">半透明
&lt;/h2>&lt;pre>&lt;code>sudo pacman -S picom
&lt;/code>&lt;/pre>
&lt;h3 id="配置i3--feh">配置i3 + feh
&lt;/h3>&lt;pre>&lt;code>nano ~/.config/i3/config
&lt;/code>&lt;/pre>
&lt;p>找到对应的行编辑，或者添加&lt;/p>
&lt;pre>&lt;code>#壁纸
exec_always --no-startup-id feh --randomize --bg-fill ~/wallpaper
#半透明
exec_always --no-startup-id picom
# start a terminal 终端
#bindsym $mod+Return exec i3-sensible-terminal
bindsym $mod+Return exec alacritty
&lt;/code>&lt;/pre>
&lt;h2 id="i3w的配置-这里不展开了自己看wiki">i3w的配置 这里不展开了，自己看wiki
&lt;/h2>&lt;p>$mod+shift+r 重载i3
$mod+d 允许 dmenu
$mod+回车 打开终端&lt;/p>
&lt;p>设置分辨率&lt;/p>
&lt;pre>&lt;code>xrandr --output Virtual-1 --mode 1920x1080
&lt;/code>&lt;/pre>
&lt;h2 id="命i3w令和配置文件整理">命i3w令和配置文件整理
&lt;/h2>&lt;p>&lt;a class="link" href="https://github.com/joyanhui/i3w" target="_blank" rel="noopener"
>https://github.com/joyanhui/i3w&lt;/a>&lt;/p>
&lt;h2 id="配额remmina">配额remmina
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo pacman -S remmina
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S libvncserver
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S spice-gtk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo pacman -S freerdp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>支持 spice vnc sftp ssh rdp&lt;/p>
&lt;h2 id="其他后续">其他后续
&lt;/h2>&lt;p>安装rustdesk &lt;a class="link" href="https://dev.leiyanhui.com/arch/rustdesk/" target="_blank" rel="noopener"
>https://dev.leiyanhui.com/arch/rustdesk/&lt;/a>&lt;/p></description></item><item><title>i3w下picom办透明 以及alacritty 的简单配置</title><link>https://dev.leiyanhui.com/arch/i3w-picom-alacritty/</link><pubDate>Tue, 15 Nov 2022 15:23:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/i3w-picom-alacritty/</guid><description>&lt;h2 id="picom">picom
&lt;/h2>&lt;h3 id="配置文件">配置文件
&lt;/h3>&lt;pre>&lt;code>mkdir ~/.config/picom/
cp /etc/xdg/picom.conf ~/.config/picom/picom.conf
nano ~/.config/picom/picom.conf
&lt;/code>&lt;/pre>
&lt;h3 id="非活动窗口透明度">非活动窗口透明度
&lt;/h3>&lt;p>在 Transparency / Opacity 这段的后面
inactive-opacity&lt;/p>
&lt;h2 id="alacritty">alacritty
&lt;/h2>&lt;h3 id="配置文件-1">配置文件
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">mkdir ~/.config/alacritty
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp /usr/share/doc/alacritty/example/alacritty.yml ~/.config/alacritty/alacritty.yml
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="字体大小">字体大小
&lt;/h3>&lt;p>直接用 ctrl 和 - + 可以调整&lt;/p>
&lt;p>或者 修改配置文件的 size 这个&lt;/p>
&lt;h3 id="更换字体">更换字体
&lt;/h3>&lt;p>修改 family 推荐用 monospace&lt;/p>
&lt;h3 id="背景透明">背景透明
&lt;/h3>&lt;p>旧版本 &lt;code>background_opacity: 0.7 &lt;/code> 新版&lt;/p>
&lt;pre>&lt;code>window:
opacity: 0.7
&lt;/code>&lt;/pre>
&lt;h3 id="xorg下无法使用fcix输入法的问题">xorg下无法使用fcix输入法的问题
&lt;/h3>&lt;p>网上资料多wayland下的，我没找到问题，同时发现 i3-sensible-terminal 也存在问题。暂时 用 terminator&lt;/p>
&lt;h2 id="terminator">terminator
&lt;/h2>&lt;pre>&lt;code>sudo pacman -S terminator
&lt;/code>&lt;/pre>
&lt;h3 id="简单配置">简单配置
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">mkdir ~/.config/terminator/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nano ~/.config/terminator/config
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[profiles]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [[default]]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> background_color = &amp;#34;#002b36&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> background_darkness = 0.7
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> background_image = None
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> background_type = transparent
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> foreground_color = &amp;#34;#e0f0f1&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> show_titlebar = False
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> use_system_font = yes
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="状态栏替换为polybar">状态栏替换为polybar
&lt;/h2>&lt;pre>&lt;code>sudo pacman -S polybar
&lt;/code>&lt;/pre>
&lt;p>手动执行一次 &lt;code>polybar&lt;/code>&lt;/p>
&lt;h3 id="创建polybar的-sh">创建polybar的 sh
&lt;/h3>&lt;pre>&lt;code>nano ~/.config/polybar/launch.sh
----------
#!/bin/bash
# Terminate already running bar instances
killall -q polybar
# Wait until the processes have been shut down
while pgrep -u $UID -x polybar &amp;gt;/dev/null; do sleep 1; done
# Launch Polybar, using default config location ~/.config/polybar/config
polybar example]
-----------
sudo chmod +x ~/.config/polybar/launch.sh
&lt;/code>&lt;/pre>
&lt;h3 id="编辑i3配置文件改为--polybar">编辑i3配置文件改为 polybar
&lt;/h3>&lt;pre>&lt;code>nano ~/.config/i3/config
&lt;/code>&lt;/pre>
&lt;p>添加一行&lt;/p>
&lt;pre>&lt;code>exec_always --no-startup-id $HOME/.config/polybar/launch.sh
&lt;/code>&lt;/pre>
&lt;h3 id="配置文件-2">配置文件
&lt;/h3>&lt;p>mkdir ~/.config/polybar
cp //etc/polybar/config.ini ~/.config/polybar/
nano ~/.config/polybar/config.ini&lt;/p>
&lt;p>另外开一个终端 ip link show 查看网卡，我这里是pve环境只有有线网卡&lt;/p>
&lt;h2 id="其他">其他
&lt;/h2>&lt;h3 id="默认中文化防止部分软件打开是英文版">默认中文化，防止部分软件打开是英文版
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## ~/.xprofile&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">LANG&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;zh_CN.UTF-8&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">export&lt;/span> &lt;span class="n">LC_ALL&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;zh_CN.UTF-8&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#export GDK_SCALE=2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#export GDK_DPI_SCALE=0.5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#export QT_AUTO_SCREEN_SCALE_FACTOR=&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="i3w主题">i3w主题
&lt;/h3>&lt;pre>&lt;code>pacman -S arc-icon-theme adwaita-icon-theme lxappearance
# 然后运行 lxappearance 可以简单配置
# adwaita-icon-theme 这个包我不太喜欢
&lt;/code>&lt;/pre>
&lt;h3 id="emoji字体">emoji字体
&lt;/h3>&lt;p>我选择apple的
yay -S ttf-apple-emoji&lt;/p></description></item><item><title>linux最好用的thunar 文件管理器的简单使用 和配置</title><link>https://dev.leiyanhui.com/arch/thunar-config/</link><pubDate>Tue, 15 Nov 2022 15:23:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/thunar-config/</guid><description>&lt;p>thunar 是一个轻量，简单易用的文件管理器。 简单易用不代表不强大。&lt;/p>
&lt;p>下面以arch为例&lt;/p>
&lt;h2 id="安装">安装
&lt;/h2>&lt;pre>&lt;code>pacman -S thunar
&lt;/code>&lt;/pre>
&lt;h2 id="usb自动挂载-以及-smb-等挂载">usb自动挂载 以及 smb 等挂载
&lt;/h2>&lt;pre>&lt;code>pacman -S gvfs
pacman -S gvfs-smb sshfs
&lt;/code>&lt;/pre>
&lt;p>重新打开 thunar 就可以啦 &lt;code>smb://, ftp://, ssh://, sftp://, davs:// &lt;/code>&lt;br>
比如&lt;/p>
&lt;ul>
&lt;li>挂载 alist的webdav &lt;code>davs://地址:50443/dav/&lt;/code>&lt;/li>
&lt;li>挂载路由器 &lt;code>sftp://10.0.0.8/&lt;/code>&lt;/li>
&lt;li>ssh：// = sftp://&lt;/li>
&lt;li>挂群晖 &lt;code>smb://10.0.0.8/sharemnt/&lt;/code>
如果自动挂在 手机或者其他需要 &lt;code>gvfs-mtp &lt;/code> 这个包&lt;/li>
&lt;/ul>
&lt;p>也可能需要&lt;code>gvfs-backends gvfs-fuse&lt;/code> 这两个包。&lt;/p>
&lt;p>其实rclone统一管理可能更方便一些&lt;/p>
&lt;h2 id="配置右键-打开shell">配置右键 打开shell
&lt;/h2>&lt;p>点 edit -&amp;gt; custom actions
编辑 &lt;code>exo-open --working-directory %f --launch TerminalEmulator&lt;/code>
我是用的 terminator，这里删掉输入 &lt;code>terminator&lt;/code>就好啦。 其他的终端自己看看urxvt:&lt;code>urxvt -e bash&lt;/code>&lt;/p>
&lt;h2 id="右键配置-codeserver">右键配置 codeserver
&lt;/h2>&lt;p>略过，用火狐http到coderserver 就好&lt;/p>
&lt;h2 id="文件关联什么的">文件关联什么的。。
&lt;/h2>&lt;p>我暂时没需求&amp;hellip;&lt;/p></description></item><item><title>Linux设置swapfile archlinux</title><link>https://dev.leiyanhui.com/arch/swapfile/</link><pubDate>Tue, 01 Nov 2022 22:07:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/swapfile/</guid><description>&lt;p>很不喜欢用swap分区，不够灵活，file方式性能略差，但差距 在使用中感觉不到。 所以我习惯性用 文件swap&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo dd if=/dev/zero of=/swapfile bs=1M count=1024 status=progress
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#必须设置，不然是一个严重安全漏洞
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo chmod 600 /swapfile
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># 格式化和启用
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo mkswap /swapfile
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo swapon /swapfile
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># 自动挂载，添加一行
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo nano /etc/fstab
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/swapfile none swap defaults 0 0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>archLinux 命令行下alsa声卡的配置的和使用</title><link>https://dev.leiyanhui.com/arch/arch-sound/</link><pubDate>Tue, 01 Nov 2022 18:50:20 +0800</pubDate><guid>https://dev.leiyanhui.com/arch/arch-sound/</guid><description>&lt;p>安装 alsa &lt;code>sudo pacman -S alsa-utils&lt;/code>&lt;/p>
&lt;p>另外可能需要把当前用户加到audio 用户组 &lt;code>sudo gpasswd -a leiyanhui audio&lt;/code> 查看组情况 &lt;code>id leiyanhui &lt;/code> ，然后重新登录一次ssh。否则远程登录的用户是没有权限播放声音的&lt;/p>
&lt;p>尝试解决 先搞定ALSA 工具 &lt;code>sudo pacman -S alsa-utils&lt;/code> 运行 &lt;code>alsamixer&lt;/code> 把MM的按m键取消静音&lt;/p>
&lt;p>测试声音 &lt;code>speaker-test -c 2&lt;/code> 测试没问题 保存 &lt;code>alsactl store&lt;/code>&lt;/p>
&lt;p>如果&lt;code>aplay -l&lt;/code>找不到声卡，那先看看有没有在kvm的把声卡id绑定到 vfio&lt;/p>
&lt;p>你也可以 &lt;code>aplay test.wav &lt;/code> 找一个音频文件播放测试&lt;/p>
&lt;p>查看声卡&lt;code> sudo aplay -l&lt;/code>&lt;/p>
&lt;pre>&lt;code>**** List of PLAYBACK Hardware Devices ****
card 0: PCH [HDA Intel PCH], device 0: ALC887-VD Analog [ALC887-VD Analog]
Subdevices: 1/1
Subdevice #0: subdevice #0
card 0: PCH [HDA Intel PCH], device 1: ALC887-VD Digital [ALC887-VD Digital]
Subdevices: 1/1
Subdevice #0: subdevice #0
card 0: PCH [HDA Intel PCH], device 3: HDMI 0 [HDMI]
Subdevices: 1/1
Subdevice #0: subdevice #0
&lt;/code>&lt;/pre>
&lt;p>先解除静音 &lt;code>sudo alsamixer&lt;/code> 用左右键找到 MM的 所有设备 点一下M 然后上下 调一下音量。&lt;/p>
&lt;p>我这里是用板载声卡，而非HDMI 所以，在板载上直接插入耳机 即可&lt;/p>
&lt;p>测试声音 &lt;code>speaker-test -c 2&lt;/code>&lt;/p>
&lt;p>如果有开kvm 或者 检查一下 /etc/modprobe.d/下的配置文件，有没有拉黑声卡驱动，
比如 blacklist.conf blacklist snd_hda_intel 要去掉，然后 重新生成initramfs &lt;code>sudo mkinitcpio -P&lt;/code>&lt;/p>
&lt;p>本文参考：https://wiki.archlinux.org/title/Advanced_Linux_Sound_Architecture_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&lt;/p></description></item></channel></rss>