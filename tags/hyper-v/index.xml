<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Hyper-V on 小类随手记</title><link>https://dev.leiyanhui.com/tags/hyper-v/</link><description>Recent content in Hyper-V on 小类随手记</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Wed, 07 Sep 2022 19:56:11 +0000</lastBuildDate><atom:link href="https://dev.leiyanhui.com/tags/hyper-v/index.xml" rel="self" type="application/rss+xml"/><item><title>hyper-v 开启虚拟化嵌套，套娃pve 为了虚拟化黑苹果</title><link>https://dev.leiyanhui.com/c/99/</link><pubDate>Wed, 07 Sep 2022 19:56:11 +0000</pubDate><guid>https://dev.leiyanhui.com/c/99/</guid><description>&lt;h1 id="hyper-v-开启虚拟化嵌套套娃pve-为了虚拟化黑苹果">hyper-v 开启虚拟化嵌套，套娃pve 为了虚拟化黑苹果
&lt;/h1>&lt;p>因为最终一些原因，舍弃了黑macos 做主力系统（远程很卡https://dev.leiyanhui.com/c/94） 切换到win下，有因为使用了docker 需要打开wsl和hyper-v，而这时候 vmware的显卡性能会大幅度下滑，所以尝试 套娃虚拟机跑macos 终端运行 查看列表 Get-VM 查看配置 ExposeVirtualizationExtensions 默认是false Get-VMProcessor -VMName PVE | fl 打开虚拟化套娃 Set-VMProcessor -ExposeVirtualizationExtensions $true -VMName PVE 查看配置 ExposeVirtualizationExtensions 默认是应该变成 true Get-VMProcessor -VMName PVE | fl 完毕 正常安装pve 最后，迁移到unraid 上了&lt;/p></description></item><item><title>hyper-v 虚拟机主机添加显卡（分配一部分显卡性能给他）</title><link>https://dev.leiyanhui.com/c/98/</link><pubDate>Wed, 07 Sep 2022 19:56:11 +0000</pubDate><guid>https://dev.leiyanhui.com/c/98/</guid><description>&lt;h1 id="hyper-v-虚拟机主机添加显卡分配一部分显卡性能给他">hyper-v 虚拟机主机添加显卡（分配一部分显卡性能给他）
&lt;/h1>&lt;p>$vm = &amp;ldquo;Win11dev&amp;rdquo; 或者 $vm = &amp;ldquo;PVE&amp;rdquo; 引号里面是虚拟机名称&lt;/p>
&lt;pre>&lt;code>Add-VMGpuPartitionAdapter -VMName
$vm Set-VMGpuPartitionAdapter -VMName
$vm -MinPartitionVRAM 80000000 -MaxPartitionVRAM 100000000 -OptimalPartitionVRAM 100000000 -MinPartitionEncode 80000000 -MaxPartitionEncode 100000000 -OptimalPartitionEncode 100000000 -MinPartitionDecode 80000000 -MaxPartitionDecode 100000000 -OptimalPartitionDecode 100000000 -MinPartitionCompute 80000000 -MaxPartitionCompute 100000000 -OptimalPartitionCompute 100000000 Set-VM -GuestControlledCacheTypes $true -VMName $vm Set-VM -LowMemoryMappedIoSpace 1Gb -VMName $vm Set-VM -HighMemoryMappedIoSpace 32GB -VMName $vm
&lt;/code>&lt;/pre>
&lt;p>虚拟机开机，&lt;/p>
&lt;p>从主机上复制C:\Windows\System32\DriverStore\FileRepository目录到虚拟机C:\Windows\System32\HostDriverStore\ 此时虚拟机上看到是这样的目录结构：C:\Windows\System32\HostDriverStore\FileRepository 备注：HostDriverStore这个目录要自己创建，
FileRepository里面本质上只要有主机显卡驱动就可以了，这里偷懒直接复制整个目录（文件挺大），如果只想复制主机显卡驱动目录，可以通过设备管理器查看主机的显卡驱动 驱动详细信息 查看显卡的驱动目录
比如 我的是
C:\Windows\System32\DriverStore\FileRepository\iigd_dch.inf_amd64_518f2921ba495409 也有900M 复制到虚拟机的&lt;/p>
&lt;p>C:\Windows\System32\HostDriverStore\FileRepository\iigd_dch.inf_amd64_518f2921ba495409 我这里是核显，如果是其他网卡 可能还需要几个dll 具体 搜索引擎 重启虚拟机，查看虚拟机设备管理器显卡，运行dxdiag查看显卡特性 成功&lt;/p></description></item></channel></rss>